
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Jorge Pastor">
      
      
        <link rel="canonical" href="https://jorgepastorr.github.io/apuntes/seguridad/cortafuegos/Iptables/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.0.2">
    
    
      
        <title>Iptables - Apuntes</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.816931ca.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.9204c3b2.min.css">
        
          
          
          <meta name="theme-color" content="#7e56c2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>function __md_scope(e,t,_){return new URL(_||(t===localStorage?"../../..":"../../.."),location).pathname+"."+e}function __md_get(e,t=localStorage,_){return JSON.parse(t.getItem(__md_scope(e,t,_)))}function __md_set(e,t,_=localStorage,o){try{_.setItem(__md_scope(e,_,o),JSON.stringify(t))}catch(e){}}</script>
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#iptables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Apuntes" class="md-header__button md-logo" aria-label="Apuntes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Apuntes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Iptables
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jorgepastorr/apuntes/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jorgepastorr/apuntes
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Apuntes" class="md-nav__button md-logo" aria-label="Apuntes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Apuntes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jorgepastorr/apuntes/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jorgepastorr/apuntes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Apuntes Jorgepastorr
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Administracion
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administracion" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Administracion
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/Configurar_pantallas_manualmente/" class="md-nav__link">
        Configurar pantallas manualmente
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/Debian_hostname_dinamico/" class="md-nav__link">
        Debian hostname dinamico
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/Mutt/" class="md-nav__link">
        Que es mutt?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/Procesos/" class="md-nav__link">
        Procesos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/Resetear_la_password_root/" class="md-nav__link">
        Resetear la password root.
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/Vim/" class="md-nav__link">
        Vim atajos básicos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/awk/" class="md-nav__link">
        Uso básico de AWK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/freeipa/" class="md-nav__link">
        FreeIpa
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/instalar_webmin/" class="md-nav__link">
        instalar webmin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/per/" class="md-nav__link">
        PER
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/permisos_avanzados/" class="md-nav__link">
        Permisos avanzados
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/samba/" class="md-nav__link">
        Samba
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/server-correo/" class="md-nav__link">
        Servidor Correo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/server-mensajeria/" class="md-nav__link">
        Server mensajeria instantanea
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/ssh/" class="md-nav__link">
        ssh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/sudo/" class="md-nav__link">
        sudo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/umask/" class="md-nav__link">
        umask
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/usuarios/" class="md-nav__link">
        Usuarios
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/vnc/" class="md-nav__link">
        vnc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/webdav/" class="md-nav__link">
        webdav
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_21" type="checkbox" id="__nav_2_21" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_21">
          Ldap
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Ldap" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_21">
          <span class="md-nav__icon md-icon"></span>
          Ldap
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/ldap/Ldap-Samba-Hostpam/" class="md-nav__link">
        Ldap - Samba - Hostpam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/ldap/acl_ejercicios/" class="md-nav__link">
        Acl ejercicios
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/ldap/host-kerberos-con-ldap/" class="md-nav__link">
        Instalación host  ldap-kerberos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/ldap/ldap/" class="md-nav__link">
        ldap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_22" type="checkbox" id="__nav_2_22" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_22">
          Pxe
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Pxe" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_22">
          <span class="md-nav__icon md-icon"></span>
          Pxe
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/pxe/Servidor-pxe-con-rapberry/" class="md-nav__link">
        Servidor pxe con rapberry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/pxe/guiapxe-fedora/" class="md-nav__link">
        Guiapxe fedora
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_23" type="checkbox" id="__nav_2_23" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_23">
          Redes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Redes" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_23">
          <span class="md-nav__icon md-icon"></span>
          Redes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/redes/apuntes-xarxa/" class="md-nav__link">
        APUNTS DE XARXES
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/redes/comandos_router_switch/" class="md-nav__link">
        Configuració de Routers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/redes/haproxy/" class="md-nav__link">
        Haproxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../administracion/redes/redes2/" class="md-nav__link">
        Redes2
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Auditoria
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Auditoria" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Auditoria
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../auditoria/apuntes_hacking/" class="md-nav__link">
        Haking ético
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Bases datos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Bases datos" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Bases datos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Mongo
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mongo" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Mongo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bases_datos/mongo/Mongo/" class="md-nav__link">
        Mongo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Postgres
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Postgres" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Postgres
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bases_datos/postgres/bases/" class="md-nav__link">
        Postgres
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bases_datos/postgres/modificaciones/" class="md-nav__link">
        Modificación tablas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bases_datos/postgres/plpgsql/" class="md-nav__link">
        Plpgsql
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bases_datos/postgres/postgresql-intalacion/" class="md-nav__link">
        Postgresql intalacion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Cloud
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cloud" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Cloud
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../cloud/aws/" class="md-nav__link">
        aws
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Curiosidades
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Curiosidades" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Curiosidades
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../curiosidades/Eliminar_contrase%C3%B1a_windows/" class="md-nav__link">
        Eliminar contraseña windows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../curiosidades/Lanzador_aplicaciones_en_gnome/" class="md-nav__link">
        Lanzador aplicaciones en gnome
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../curiosidades/cambiar_color_promp_terminal/" class="md-nav__link">
        Cambiar color promp terminal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../curiosidades/conky/" class="md-nav__link">
        conky
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../curiosidades/openbox/" class="md-nav__link">
        Openbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../curiosidades/qbit/" class="md-nav__link">
        Qbit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../curiosidades/tmux/" class="md-nav__link">
        Tmux
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Desatendidas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Desatendidas" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Desatendidas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../desatendidas/" class="md-nav__link">
        Desatendidas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../desatendidas/Instalacion-desatendida-debian/" class="md-nav__link">
        Instalacion desatendida debian
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../desatendidas/desatendida-windows/" class="md-nav__link">
        Desatendida windows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../desatendidas/kikstart/" class="md-nav__link">
        Kikstart
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Generar doc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Generar doc" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Generar doc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../generar_doc/docsify/" class="md-nav__link">
        Docsify
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../generar_doc/remark/" class="md-nav__link">
        Remark
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Lenguajes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lenguajes" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Lenguajes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/Fundamentos_php/" class="md-nav__link">
        Fundamentos php
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/Shell/" class="md-nav__link">
        Shell
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_3" type="checkbox" id="__nav_9_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9_3">
          Python3
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python3" data-md-level="2">
        <label class="md-nav__title" for="__nav_9_3">
          <span class="md-nav__icon md-icon"></span>
          Python3
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/Apuntes-Metodos/" class="md-nav__link">
        Métodos de colecciones
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-Funcionalidades_avanzadas/" class="md-nav__link">
        apuntes Funcionalidades avanzadas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-Herencia/" class="md-nav__link">
        Herencias
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-distribucion/" class="md-nav__link">
        Distribución
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-documentacion/" class="md-nav__link">
        Documentación
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-ficheros/" class="md-nav__link">
        Apuntes ficheros
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-fundamento/" class="md-nav__link">
        Python fundamentos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-modulos/" class="md-nav__link">
        Módulos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-orientado-objetos/" class="md-nav__link">
        Orientado a objetos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-test/" class="md-nav__link">
        Test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes-tkinter/" class="md-nav__link">
        Tkinter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/apuntes_bases/" class="md-nav__link">
        Apuntes bases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../lenguajes/python3/argparse/" class="md-nav__link">
        Argparse
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Seguridad
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Seguridad" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Seguridad
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Certificados-Digitales/" class="md-nav__link">
        Certificados Digitales
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kerberos/" class="md-nav__link">
        Kerberos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../OpenVpn/" class="md-nav__link">
        OpenVpn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../The-crazy-thing/" class="md-nav__link">
        The crazy thing!
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../TunelSSH/" class="md-nav__link">
        Tunel SSH
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../gpg/" class="md-nav__link">
        GPG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../lvm/" class="md-nav__link">
        Lvm logical volum manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../practica-ssl-tls/" class="md-nav__link">
        Practica ssl tls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../raid/" class="md-nav__link">
        Raid
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_10" type="checkbox" id="__nav_10_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10_10">
          Backups
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Backups" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_10">
          <span class="md-nav__icon md-icon"></span>
          Backups
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backups/Borg_basico/" class="md-nav__link">
        Borg básico
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backups/Tar/" class="md-nav__link">
        Tar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backups/rdiff-backup/" class="md-nav__link">
        rdiff-backup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../backups/rsync/" class="md-nav__link">
        rsync
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_11" type="checkbox" id="__nav_10_11" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_10_11">
          Cortafuegos
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cortafuegos" data-md-level="2">
        <label class="md-nav__title" for="__nav_10_11">
          <span class="md-nav__icon md-icon"></span>
          Cortafuegos
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Iptables
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Iptables
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reglas-y-acciones" class="md-nav__link">
    Reglas y Acciones
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activar-host-hacer-router" class="md-nav__link">
    Activar host hacer router
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#borrar-reglas-actuales" class="md-nav__link">
    Borrar reglas actuales
  </a>
  
    <nav class="md-nav" aria-label="Borrar reglas actuales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#borrar-una-regla" class="md-nav__link">
    Borrar una regla
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#politica-por-defecto" class="md-nav__link">
    Politica por defecto
  </a>
  
    <nav class="md-nav" aria-label="Politica por defecto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accept" class="md-nav__link">
    Accept
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop" class="md-nav__link">
    Drop
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permitir-todo-via-localhost" class="md-nav__link">
    Permitir todo vía localhost
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permitir-todo-en-propia-ip" class="md-nav__link">
    Permitir todo en propia ip
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permitir-una-ipred-a-puerto" class="md-nav__link">
    Permitir una ip/red a puerto
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cerrar-puerto-al-exterior" class="md-nav__link">
    Cerrar puerto al exterior
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guardar-reglas-actuales" class="md-nav__link">
    Guardar reglas actuales
  </a>
  
    <nav class="md-nav" aria-label="Guardar reglas actuales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backup" class="md-nav__link">
    Backup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sourceport" class="md-nav__link">
    sourceport
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permitir-trafico-establecido" class="md-nav__link">
    Permitir trafico establecido
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#servicios-en-drop" class="md-nav__link">
    Servicios en drop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forwarding" class="md-nav__link">
    Forwarding
  </a>
  
    <nav class="md-nav" aria-label="Forwarding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nat" class="md-nav__link">
    Nat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward" class="md-nav__link">
    Forward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnat" class="md-nav__link">
    Dnat
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#icmp" class="md-nav__link">
    Icmp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo-drop" class="md-nav__link">
    Ejemplo Drop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo-dmz" class="md-nav__link">
    Ejemplo DMZ
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Sistemas
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sistemas" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Sistemas
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/Actualizar_hora_sys_o_bios/" class="md-nav__link">
        Gestionar Hora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/Arranque-del-sistema/" class="md-nav__link">
        Arranque del sistema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/Estructura_de_directorios/" class="md-nav__link">
        Estructura de directorios
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/Logs/" class="md-nav__link">
        Logs del sistema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/Systemd/" class="md-nav__link">
        Systemd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/ZFS/" class="md-nav__link">
        ZFS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/chroot/" class="md-nav__link">
        Chroot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/disco/" class="md-nav__link">
        Disco
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/gestores_de_paquetes/" class="md-nav__link">
        Gestores de paquetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/getenforce/" class="md-nav__link">
        getenforce
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/grub/" class="md-nav__link">
        Grub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/home/" class="md-nav__link">
        Cambiar /home
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/ip_est%C3%A1tica/" class="md-nav__link">
        ip estática raspberry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/pam/" class="md-nav__link">
        Pam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/raid/" class="md-nav__link">
        Raid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/xinetd/" class="md-nav__link">
        xinetd
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_17" type="checkbox" id="__nav_11_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11_17">
          Automatizacion
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Automatizacion" data-md-level="2">
        <label class="md-nav__title" for="__nav_11_17">
          <span class="md-nav__icon md-icon"></span>
          Automatizacion
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/automatizacion/ansible/" class="md-nav__link">
        Ansible
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../sistemas/automatizacion/tareas_programadas/" class="md-nav__link">
        Tareas Programadas
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          Virtualizacion
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Virtualizacion" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Virtualizacion
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/Docker-basico/" class="md-nav__link">
        Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/Lxc/" class="md-nav__link">
        LXC y LXD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/Vagrant/" class="md-nav__link">
        Vagrant
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/kubernetes/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/swarm/" class="md-nav__link">
        Swarm
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12_6" type="checkbox" id="__nav_12_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12_6">
          Virt manager
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Virt manager" data-md-level="2">
        <label class="md-nav__title" for="__nav_12_6">
          <span class="md-nav__icon md-icon"></span>
          Virt manager
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/virt-manager/Backing_chain/" class="md-nav__link">
        Backing_chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/virt-manager/Clonar/" class="md-nav__link">
        Clonar de virtual a físico y de físico a virtual.
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/virt-manager/Instalacion_de_virtualizacion_fedora/" class="md-nav__link">
        Instalación de virtualización fedora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/virt-manager/acceder_consola_desde_virsh/" class="md-nav__link">
        acceder consola desde virsh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/virt-manager/crear_red_aislada/" class="md-nav__link">
        Crear red aislada
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../virtualizacion/virt-manager/instalar_maquina_virtual_virt-install/" class="md-nav__link">
        virt
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reglas-y-acciones" class="md-nav__link">
    Reglas y Acciones
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activar-host-hacer-router" class="md-nav__link">
    Activar host hacer router
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#borrar-reglas-actuales" class="md-nav__link">
    Borrar reglas actuales
  </a>
  
    <nav class="md-nav" aria-label="Borrar reglas actuales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#borrar-una-regla" class="md-nav__link">
    Borrar una regla
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#politica-por-defecto" class="md-nav__link">
    Politica por defecto
  </a>
  
    <nav class="md-nav" aria-label="Politica por defecto">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#accept" class="md-nav__link">
    Accept
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drop" class="md-nav__link">
    Drop
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permitir-todo-via-localhost" class="md-nav__link">
    Permitir todo vía localhost
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permitir-todo-en-propia-ip" class="md-nav__link">
    Permitir todo en propia ip
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permitir-una-ipred-a-puerto" class="md-nav__link">
    Permitir una ip/red a puerto
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cerrar-puerto-al-exterior" class="md-nav__link">
    Cerrar puerto al exterior
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guardar-reglas-actuales" class="md-nav__link">
    Guardar reglas actuales
  </a>
  
    <nav class="md-nav" aria-label="Guardar reglas actuales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backup" class="md-nav__link">
    Backup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sourceport" class="md-nav__link">
    sourceport
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permitir-trafico-establecido" class="md-nav__link">
    Permitir trafico establecido
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#servicios-en-drop" class="md-nav__link">
    Servicios en drop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forwarding" class="md-nav__link">
    Forwarding
  </a>
  
    <nav class="md-nav" aria-label="Forwarding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nat" class="md-nav__link">
    Nat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward" class="md-nav__link">
    Forward
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnat" class="md-nav__link">
    Dnat
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#icmp" class="md-nav__link">
    Icmp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo-drop" class="md-nav__link">
    Ejemplo Drop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ejemplo-dmz" class="md-nav__link">
    Ejemplo DMZ
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/jorgepastorr/apuntes/edit/master/docs/seguridad/cortafuegos/Iptables.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="iptables">Iptables</h1>
<h2 id="reglas-y-acciones">Reglas y Acciones</h2>
<p>Las reglas se evalúan una a una secuencial mente en orden descendente, si una orden coincide con otra hace match, se aplica la primera, es decir si hay una regla que abre el puerto 5000 para la ip 1 y mas abajo hay otra regla que cierra el puerto 5000 para la ip 1,  la segunda nunca se aplicara.</p>
<h2 id="activar-host-hacer-router">Activar host hacer router</h2>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span> <span class="m">1</span> &gt; /proc/sys/net/ipv4/ip_forward
</code></pre></div>
<h2 id="borrar-reglas-actuales">Borrar reglas actuales</h2>
<div class="highlight"><pre><span></span><code>sudo iptables -F
sudo iptables -X
sudo iptables -Z
sudo iptables -t nat -F
</code></pre></div>
<h3 id="borrar-una-regla">Borrar una regla</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Primer les mostrem amb nº de línia</span>
iptables -t filter -n -L -v --line-numbers
iptables -t nat -n -L -v --line-numbers
iptables -t mangle -n -L -v --line-numbers

<span class="c1"># Esborrar la 4</span>
iptables -D INPUT <span class="m">4</span>
</code></pre></div>
<h2 id="politica-por-defecto">Politica por defecto</h2>
<p>Existen dos políticas por defecto ACCEPT y DROP, generalmente se establece en el inicio de los scripts cual sera su política,  aceptar todo por defecto o denegar todo por defecto.</p>
<h3 id="accept">Accept</h3>
<p>En la política Accept todo esta permitido excepto lo que explícitamente se deniegue, en este caso las reglas de firewall son una lista de lo que está prohibido. Esta política es la mas fácil de configurar pero el firewall nunca será del todo seguro.</p>
<div class="highlight"><pre><span></span><code>sudo iptables -P INPUT ACCEPT
sudo iptables -P OUTPUT ACCEPT
sudo iptables -P FORWARD ACCEPT
sudo iptables -t nat -P PREROUTING ACCEPT
sudo iptables -t nat -P POSTROUTING ACCEPT
</code></pre></div>
<h3 id="drop">Drop</h3>
<p>Esta es la política mas difícil de configurar pero es mas segura, por que por defecto todo esta denegado y se han de asignar en las reglas del firewall  todo lo que se permita, asegurándote no olvidarte ninguna opción imprescindible.</p>
<div class="highlight"><pre><span></span><code>sudo iptables -P INPUT DROP
sudo iptables -P OUTPUT DROP
sudo iptables -P FORWARD DROP
sudo iptables -t nat -P PREROUTING DROP
sudo iptables -t nat -P POSTROUTING DROP
</code></pre></div>
<p>Uno de los errores que pueden ocurrir si las reglas no se han asignado bien, es que el sistema se quede bloqueado por haber cerrado demasiados servicios necesarios para el funcionamiento.</p>
<ul>
<li>toda comunicación de red tiene dos sentidos.</li>
<li>hace falta permitir los dos sentidos para considerar accesible un servicio.</li>
<li>el trafico de respuesta se puede identificar con modificadores tipo related, established.</li>
<li>el trafico necesario para el sistema a de estar abierto</li>
<li>dns, sincronización horaria, pings, Ldap, Kerberos, NFS, samba, sgún de que dependa la máquina para su funcionamiento.</li>
</ul>
<h2 id="permitir-todo-via-localhost">Permitir todo vía localhost</h2>
<div class="highlight"><pre><span></span><code>sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A OUTPUT -o lo -j ACCEPT
</code></pre></div>
<p><code>-i</code> input-interface, <code>-o</code> output-interface</p>
<h2 id="permitir-todo-en-propia-ip">Permitir todo en propia ip</h2>
<div class="highlight"><pre><span></span><code>sudo iptables -A INPUT -s <span class="m">192</span>.168.88.2 -j ACCEPT
sudo iptables -A OUTPUT -d <span class="m">192</span>.168.88.2 -j ACCEPT
</code></pre></div>
<p><code>-s</code>  source(origen) <code>-d</code> destination</p>
<h2 id="permitir-una-ipred-a-puerto">Permitir una ip/red a puerto</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># permitir acceder una red a un puerto</span>
sudo iptables -A INPUT -s <span class="m">192</span>.168.88.0/24 -p tcp --dport <span class="m">5432</span> -j ACCEPT
<span class="c1"># permitir una ip a un rango de puertos</span>
sudo iptables -A INPUT -s <span class="m">80</span>.37.45.194 -p tcp --dport <span class="m">20</span>:21 -j ACCEPT
<span class="c1"># permitir una ip a un puerto</span>
sudo iptables -A INPUT -s <span class="m">80</span>.37.45.194 -p tcp --dport <span class="m">80</span> -j ACCEPT
</code></pre></div>
<h2 id="cerrar-puerto-al-exterior">Cerrar puerto al exterior</h2>
<div class="highlight"><pre><span></span><code>sudo iptables -A INPUT -p tcp --dport <span class="m">20</span>:21 -j DROP
sudo iptables -A INPUT -p tcp --dport <span class="m">5432</span> -j DROP
sudo iptables -A INPUT -p tcp --dport <span class="m">80</span> -j DROP
</code></pre></div>
<h2 id="guardar-reglas-actuales">Guardar reglas actuales</h2>
<div class="highlight"><pre><span></span><code>sudo iptables-save &gt; /etc/sysconfig/iptables
</code></pre></div>
<h3 id="backup">Backup</h3>
<div class="highlight"><pre><span></span><code>sudo iptables-save &gt; arxiu.regles.iptables <span class="c1"># exportar</span>
sudo iptables-restore &lt; arxiu.regles.iptables <span class="c1"># inportar</span>
</code></pre></div>
<h2 id="sourceport">sourceport</h2>
<p>En este ejemplo quiero que el host pueda navegar por internet, pero este mismo host tiene un servidor web y  quiero que desde el exterior puedan acceder, por lo tanto añado la regla de aceptar entrada por source port (esto solo es estrictamente necesario en la política drop). </p>
<div class="highlight"><pre><span></span><code>sudo iptables -A INPUT -p tcp -m tcp --sport <span class="m">80</span> -m state <span class="se">\</span>
                    --state RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -p tcp -m tcp --dport <span class="m">80</span> -j ACCEPT

sudo iptables -A INPUT -p tcp -m tcp --sport <span class="m">443</span> -m state <span class="se">\</span>
                    --state RELATED,ESTABLISHED -j ACCEPT
sudo iptables -A OUTPUT -p tcp -m tcp --dport <span class="m">443</span> -j ACCEPT

sudo iptables -A INPUT -p tcp --dport <span class="m">80</span> -j DROP
sudo iptables -A INPUT -p tcp --dport <span class="m">443</span> -j DROP
</code></pre></div>
<p><strong>ESTABLECIDO</strong> significa que el paquete está asociado con una conexión que  ha visto paquetes en ambos direcciones</p>
<p><strong>NUEVO</strong> que significa que el  paquete ha comenzado una nueva conexión, o asociado con una conexión que no ha visto paquetes en ambas direcciones,</p>
<p><strong>RELACIONADO</strong> que significa  que el paquete está iniciando una nueva conexión, pero está asociado con una conexión existente, como una transferencia de datos FTP o un ICMP</p>
<hr />
<p>En este caso el ejemplo es de un host/firewall con política DROP que almacena un servidor web pero no tiene acceso de salida a internet, es decir el servidor web no puede hacer nuevas peticiones por http/s, pero si le permitimos que mande respuestas a las peticiones que le llegan.</p>
<div class="highlight"><pre><span></span><code>iptables -A INTPUT -p tcp -m tcp --dport <span class="m">80</span> -j ACCEPT
iptables -A OUTPUT -p tcp -m tcp --sport <span class="m">80</span> -m state <span class="se">\</span>
                        --state RELATED,ESTABLISHED -j ACCEPT

iptables -A INTPUT  -p tcp -m tcp --dport <span class="m">443</span> -j ACCEPT
iptables -A OUTPUT -p tcp -m tcp --sport <span class="m">443</span> -m state <span class="se">\</span>
                            --state RELATED,ESTABLISHED -j ACCEPT

iptables -A OUTPUT -p tcp --dport <span class="m">443</span> -j DROP
iptables -A OUTPUT -p tcp --dport <span class="m">80</span> -j DROP
</code></pre></div>
<h2 id="permitir-trafico-establecido">Permitir trafico establecido</h2>
<div class="highlight"><pre><span></span><code>iptables -t filter -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -t filter -A OUPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
</code></pre></div>
<h2 id="servicios-en-drop">Servicios en drop</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Permetre consultes DNS (primari i secundari)</span>
/sbin/iptables -A INPUT  -s <span class="m">80</span>.58.61.250 -p udp --sport <span class="m">53</span> -j ACCEPT
/sbin/iptables -A OUTPUT -d <span class="m">80</span>.58.61.250 -p udp --dport <span class="m">53</span> -j ACCEPT

/sbin/iptables -A INPUT  -s <span class="m">80</span>.58.61.254 -p udp --sport <span class="m">53</span> -j ACCEPT
/sbin/iptables -A OUTPUT -d <span class="m">80</span>.58.61.254 -p udp --dport <span class="m">53</span> -j ACCEPT

<span class="c1"># Actuar de servidor web el host/firewall</span>
/sbin/iptables -A INPUT -p tcp -m tcp --dport <span class="m">80</span> -j ACCEPT
/sbin/iptables -A OUTPUT -p tcp -m tcp --sport <span class="m">80</span> -m state <span class="se">\</span>
                        --state RELATED,ESTABLISHED -j ACCEPT

<span class="c1"># Permetre al host/firewall navegar per internet</span>
/sbin/iptables -A INPUT -p tcp -m tcp --sport <span class="m">80</span> -m state <span class="se">\</span>
                        --state RELATED,ESTABLISHED -j ACCEPT
/sbin/iptables -A OUTPUT -p tcp -m tcp --dport <span class="m">80</span> -j ACCEPT

/sbin/iptables -A INPUT  -p tcp -m tcp --sport <span class="m">443</span> -m state <span class="se">\</span>
                        --state RELATED,ESTABLISHED -j ACCEPT
/sbin/iptables -A OUTPUT -p tcp -m tcp --dport <span class="m">443</span> -j ACCEPT

<span class="c1"># Consultar al servidor de temps per permetre la sincronització horària</span>
/sbin/iptables -A INPUT  -p udp -m udp --dport <span class="m">123</span> -j ACCEPT
/sbin/iptables -A OUTPUT -p udp -m udp --sport <span class="m">123</span> -j ACCEPT

<span class="c1"># Permetre el tràfic SMTP d’entrada i sortida</span>
iptables -A INPUT  -s <span class="m">0</span>.0.0.0/0 -p tcp --dport <span class="m">25</span> -j ACCEPT
iptables -A OUTPUT -s <span class="m">0</span>.0.0.0/0 -p tcp --dport <span class="m">25</span> -j ACCEPT

<span class="c1"># Servei FTP actiu i passiu</span>
/sbin/iptables -A INPUT -p tcp -m tcp --sport <span class="m">20</span>:21 -m state <span class="se">\</span>
                            --state RELATED,ESTABLISHED -j ACCEPT
/sbin/iptables -A OUTPUT -p tcp -m tcp --dport <span class="m">20</span>:21 -j ACCEPT

<span class="c1"># puertos no sistema</span>
/sbin/iptables -A INPUT -p tcp -m tcp --sport <span class="m">1024</span>:65535 --dport <span class="m">1024</span>:65535 -m state <span class="se">\</span>
                            --state ESTABLISHED -j ACCEPT
/sbin/iptables -A OUTPUT -p tcp -m tcp --dport <span class="m">1024</span>:65535 -m state <span class="se">\</span>
                            --state NEW,RELATED,ESTABLISHED -j ACCEPT
</code></pre></div>
<p>En ocasiones la política drop hace demasiado bien su trabajo y al abrir nuevos servicios, fallan por que les esta cortando el firewall y se pone en política accept temporalmente mientras se soluciona el script por prisas o etc..  por esto mismo es una buena practica al final del script  poner la barrera drop y así no exponer datos sensibles que podamos tener..</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Barrera final DROP per si es canvia a ACCEPT temporalment</span>
<span class="c1"># tancar tràfic no desitjat</span>
/sbin/iptables -A INPUT -p tcp -m tcp --dport <span class="m">1</span>:1024 -j DROP
/sbin/iptables -A INPUT -p udp -m udp --dport <span class="m">1</span>:1024 -j DROP
/sbin/iptables -A INPUT -p tcp -m tcp --dport <span class="m">1723</span> -j DROP
/sbin/iptables -A INPUT -p tcp -m tcp --dport <span class="m">3306</span> -j DROP
/sbin/iptables -A INPUT -p tcp -m tcp --dport <span class="m">5432</span> -j DROP
</code></pre></div>
<h2 id="forwarding">Forwarding</h2>
<div class="highlight"><pre><span></span><code>$ <span class="nb">echo</span> <span class="m">1</span> &gt; /proc/sys/net/ipv4/ip_forward
<span class="c1"># o be:</span>
sysctl net.ipv4.ip_forward<span class="o">=</span><span class="m">1</span>

sysctl -a <span class="p">|</span> grep ip_forward
net.ipv4.ip_forward <span class="o">=</span> <span class="m">1</span>
</code></pre></div>
<p>En un firewall por defecto la red externa suele tener todos los puertos cerrados y la interna abiertos, <code>eth0</code> interficie externa, <code>eth1</code> interficie interna.</p>
<div class="highlight"><pre><span></span><code>iptables -A INPUT -s <span class="m">0</span>.0.0.0  -i eth0 -j DROP
iptables -A INPUT -s <span class="m">172</span>.16.10.0/24 -i eth1 -j ACCEPT
</code></pre></div>
<h3 id="nat">Nat</h3>
<p><strong>Network Addres Translation</strong> se le aplica cuando en un router o host/firewall con dos o mas interficies, recibe peticiones por un red y las devuelve por otra con una ip diferente, en este proceso se a aplicado un <code>forward</code> a recibido un paquete por una red, a mirado de quien era y se lo a enviado estando en una red diferente el destinatario.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># NAT usant la IP pública de eth0</span>
iptables -t nat -A POSTROUTING -s <span class="m">172</span>.16.10.0/24 -o eth0 -j MASQUERADE
</code></pre></div>
<h3 id="forward">Forward</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># no deixar sortir de la lan a exterior a serveis concrets</span>
iptables -A FORWARD -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">7</span> -j REJECT
iptables -A FORWARD -s <span class="m">172</span>.16.100.11 -p tcp --dport <span class="m">13</span> -j REJECT

<span class="c1"># no deixar sortir de la lan a exterior segons destí</span>
iptables -A FORWARD -s <span class="m">172</span>.16.100.0/24 -d <span class="m">192</span>.168.1.34 -p tcp --dport <span class="m">23</span> -j REJECT
iptables -A FORWARD -i em1 -d <span class="m">192</span>.168.1.0/24 -p tcp --dport <span class="m">82</span> -j REJECT

<span class="c1"># un host de la lan concret no pot accedir a un servei extern (segons destí)</span>
iptables -A FORWARD -s <span class="m">172</span>.16.100.11 -d <span class="m">192</span>.168.1.34 -p tcp --dport <span class="m">110</span> -j REJECT
iptables -A FORWARD -s <span class="m">172</span>.16.100.11 -d <span class="m">192</span>.168.1.0/24 -p tcp --dport <span class="m">143</span> -j REJECT

<span class="c1"># evitar que des de dins de la LAN es falsifiqui ip origen (spoofing)</span>
iptables -A FORWARD ! -s <span class="m">172</span>.16.100.0/24 -i em1 -j REJECT
</code></pre></div>
<h3 id="dnat">Dnat</h3>
<p><strong>Destination network address translation</strong> es muy similar a NAT pero en DNAT se redirige el puerto a otro diferente, igual que NAT también se puede redirigir el destino. Es decir en NAT redirigimos de <code>ip a ip</code> y en DNAT de <code>ip:puerto a ip:puerto</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># dirigir tot el tràfic http port 80 a un altre host de la LAN</span>
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport <span class="m">80</span> -j DNAT --to <span class="m">192</span>.168.10.12:80
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport <span class="m">443</span> -j DNAT --to <span class="m">192</span>.168.10.12:443

<span class="c1"># si el tràfic hhtp prové de de casa meva (221.15.15.15) enviar-lo a un altre web server</span>
<span class="c1"># (aquesta regla ha d’anar abans de les anteriors)</span>
iptables -t nat -A PREROUTING -s <span class="m">221</span>.15.15.15 -i eth0 -p tcp --dport <span class="m">80</span> -j DNAT <span class="se">\</span>
                            --to <span class="m">192</span>.168.10.10:80
iptables -t nat -A PREROUTING -s <span class="m">221</span>.15.15.15 -i eth0 -p tcp --dport <span class="m">443</span> -j DNAT <span class="se">\</span>
                            --to <span class="m">192</span>.168.10.10:443

<span class="c1"># obrir puerto 2022 e la interfaz enp3s0 y redirigir a 192.168.10.10:22</span>
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport <span class="m">2022</span> -j DNAT --to <span class="m">192</span>.168.10.10:22

<span class="c1"># port forwarding según la red de origen</span>
iptables -t nat -A PREROUTING -s <span class="m">172</span>.17.0.0/24 -i eth0 -p tcp --dport <span class="m">2022</span> -j DNAT --to <span class="m">192</span>.168.10.10:22
</code></pre></div>
<h2 id="icmp">Icmp</h2>
<div class="highlight"><pre><span></span><code>iptables -A FORWARD -p icmp --icmp-type <span class="m">8</span> -j DROP

<span class="c1"># habilitar ping</span>
iptables -A INPUT -p icmp --icmp-type echo-reply -j ACCEPT
iptables -A OUTPUT -p icmp --icmp-type echo-request -j ACCEPT

<span class="c1"># no aceptar ping</span>
iptables -A INPUT -p ICMP -j DROP
<span class="c1"># o</span>
iptables -A INPUT -p icmp --icmp-type <span class="m">8</span> -j DROP
iptables -A OUTPUT -p icmp --icmp-type <span class="m">8</span> -j DROP
</code></pre></div>
<p>echo-reply (pong)</p>
<p>echo-request (ping)</p>
<p>=&gt; <strong>Zero</strong> (0) is for echo-reply</p>
<p>=&gt; <strong>Eight</strong> (8) is for echo-request.</p>
<h2 id="ejemplo-drop">Ejemplo Drop</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Regles Flush: buidar les regles actuals</span>
iptables -F
iptables -X
iptables -Z
iptables -t nat -F

<span class="c1"># Establir la politica per defecte (ACCEPT o DROP)</span>
iptables -P INPUT DROP
iptables -P OUTPUT DROP
iptables -P FORWARD DROP

<span class="c1"># Permetre totes les pròpies connexions via localhost</span>
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT

<span class="c1"># Permetre tot el trafic de la pròpia ip(192.168.1.49))</span>
iptables -A INPUT -s <span class="m">192</span>.168.1.35 -j ACCEPT
iptables -A OUTPUT -d <span class="m">192</span>.168.1.35 -j ACCEPT
<span class="c1">#exit 0</span>
<span class="c1"># -----------------------------------------------------------</span>

<span class="c1"># consulta dns primari</span>
iptables -A INPUT -s <span class="m">80</span>.58.61.250 -p udp -m udp --sport <span class="m">53</span> -j ACCEPT
iptables -A OUTPUT -d <span class="m">80</span>.58.61.250 -p udp -m udp --dport <span class="m">53</span> -j ACCEPT

<span class="c1"># consulta dns secundari</span>
iptables -A INPUT -s <span class="m">80</span>.58.61.254 -p udp -m udp --sport <span class="m">53</span> -j ACCEPT
iptables -A OUTPUT -d <span class="m">80</span>.58.61.254 -p udp -m udp --dport <span class="m">53</span> -j ACCEPT

<span class="c1"># consulta ntp</span>
iptables -A INPUT -p udp -m udp --dport <span class="m">123</span> -j ACCEPT
iptables -A OUTPUT -p udp -m udp --sport <span class="m">123</span> -j ACCEPT

<span class="c1"># ----------------------------------------------------------</span>
<span class="c1"># servei cups</span>
iptables -A INPUT -p tcp --dport <span class="m">631</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">631</span> -j ACCEPT

<span class="c1"># port xinetd</span>
iptables -A INPUT -p tcp --dport <span class="m">3411</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">3411</span> -j ACCEPT

<span class="c1"># port x11-x-forwarding</span>
iptables -A INPUT -p tcp --dport <span class="m">6010</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">6010</span> -j ACCEPT

<span class="c1"># servei rpc</span>
iptables -A INPUT -p tcp --dport <span class="m">111</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">111</span> -j ACCEPT

<span class="c1"># -----------------------------------------------------------</span>

<span class="c1"># icmp</span>
iptables -A INPUT -p icmp --icmp-type echo-reply -j ACCEPT
iptables -A OUTPUT -p icmp --icmp-type echo-request -j ACCEPT

<span class="c1"># -----------------------------------------------------------</span>

<span class="c1"># servei ssh</span>
iptables -A INPUT -p tcp --dport <span class="m">22</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">22</span> -j ACCEPT

<span class="c1"># servei http</span>
iptables -A INPUT -p tcp --dport <span class="m">80</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">80</span> -j ACCEPT

<span class="c1"># servei daytime</span>
iptables -A INPUT -p tcp --dport <span class="m">13</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">13</span> -j ACCEPT

<span class="c1"># servei echo</span>
iptables -A INPUT -p tcp --dport <span class="m">7</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">7</span> -j ACCEPT

<span class="c1"># servei smtp</span>
iptables -A INPUT -p tcp --dport <span class="m">25</span> -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">25</span> -j ACCEPT
<span class="c1"># exit 0</span>

<span class="c1"># ==============================================================</span>
<span class="c1"># atencio: cal millorar aquestes regles!!!          *****</span>
<span class="c1"># cal que nomes es permeti trafic relacionat        *****</span>
<span class="c1"># ==============================================================</span>

<span class="c1"># navegar web</span>
<span class="c1">#iptables -A INPUT -p tcp --sport 80 -j ACCEPT</span>
iptables -A OUTPUT -p tcp --dport <span class="m">80</span> -j ACCEPT
iptables -A INPUT -p tcp --sport <span class="m">443</span> -j ACCEPT
iptables -A OUTPUT -p tcp --dport <span class="m">443</span> -j ACCEPT

<span class="c1"># accedir a servei echo</span>
<span class="c1">#iptables -A INPUT -p tcp --sport 7 -j ACCEPT</span>
iptables -A OUTPUT -p tcp --dport <span class="m">7</span> -j ACCEPT

<span class="c1"># accedir al servei daytime</span>
<span class="c1">#iptables -A INPUT -p tcp --sport 13 -j ACCEPT</span>
iptables -A OUTPUT -p tcp --dport <span class="m">13</span> -j ACCEPT

<span class="c1"># accedir al servei ssh</span>
<span class="c1">#iptables -A INPUT -p tcp --sport 22 -j ACCEPT</span>
iptables -A OUTPUT -p tcp --dport <span class="m">22</span> -j ACCEPT

iptables -A INPUT -m state --state ESTABLISHED,RELATED
iptables -A OUTPUT -m state --state ESTABLISHED,RELATED

<span class="c1"># -----------------------------------------------------------------</span>
<span class="c1"># ftp i tftp (trafic udp)               *****</span>
<span class="c1"># -----------------------------------------------------------------</span>

<span class="c1"># oferir servei tftp</span>
iptables -A INPUT -p udp --dport <span class="m">69</span> -j ACCEPT
iptables -A OUTPUT -p udp --sport <span class="m">69</span> -j ACCEPT

<span class="c1"># accedir a serveis tftp externs</span>
iptables -A INPUT -p udp --sport <span class="m">69</span> -j ACCEPT
iptables -A OUTPUT -p udp --dport <span class="m">69</span> -j ACCEPT

<span class="c1"># pendent obrir ports dinamics</span>
<span class="c1"># oferir servei ftp</span>
iptables -A INPUT -p tcp --dport <span class="m">20</span>:21 -j ACCEPT
iptables -A OUTPUT -p tcp --sport <span class="m">20</span>:21 -j ACCEPT

<span class="c1"># accdir a serveis ftp externs</span>
iptables -A INPUT -p tcp --sport <span class="m">20</span>:21 -j ACCEPT
iptables -A OUTPUT -p tcp --dport <span class="m">20</span>:21 -j ACCEPT

<span class="c1"># pendent obrir ports dinamics!</span>
<span class="c1"># --------------------------------------------------------------</span>
<span class="c1"># Barrera per tancar els serveis/ports en cas de passar a drop</span>
<span class="c1"># ...</span>
</code></pre></div>
<h2 id="ejemplo-dmz">Ejemplo DMZ</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Activar si el host ha de fer de router</span>
<span class="nb">echo</span> <span class="m">1</span> &gt; /proc/sys/net/ipv4/ip_forward

<span class="c1"># Regles Flush: buidar les regles actuals</span>
iptables -F
iptables -X
iptables -Z
iptables -t nat -F

<span class="c1"># Establir la politica per defecte (ACCEPT o DROP)</span>
iptables -P INPUT ACCEPT
iptables -P OUTPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -t nat -P PREROUTING ACCEPT
iptables -t nat -P POSTROUTING ACCEPT

<span class="c1"># Permetre totes les pròpies connexions via localhost</span>
iptables -A INPUT -i lo -j ACCEPT
iptables -A OUTPUT -o lo -j ACCEPT

<span class="c1"># Permetre tot el trafic de la propia ip exterior (wlan0:192.168.1.41))</span>
iptables -A INPUT -s <span class="m">192</span>.168.1.41 -j ACCEPT
iptables -A OUTPUT -d <span class="m">192</span>.168.1.41 -j ACCEPT

<span class="c1"># Permetre tot el trafic de la propia ip interior (em1:172.16.100.1))</span>
iptables -A INPUT -s <span class="m">172</span>.16.100.1 -j ACCEPT
iptables -A OUTPUT -d <span class="m">172</span>.16.100.1 -j ACCEPT

<span class="c1"># Permetre tot el trafic de la propia ip interior (em1:172.32.1.1))</span>
iptables -A INPUT -s <span class="m">172</span>.32.1.1 -j ACCEPT
iptables -A OUTPUT -d <span class="m">172</span>.32.1.1 -j ACCEPT
<span class="c1">#exit 0</span>

<span class="c1"># Ahora hacemos enmascaramiento de la red local (HACIA FUERA)</span>
iptables -t nat -A POSTROUTING -s <span class="m">172</span>.16.100.0/24 -o wlan0 -j MASQUERADE
iptables -t nat -A POSTROUTING -s <span class="m">172</span>.32.1.0/24 -o wlan0 -j MASQUERADE
<span class="c1">#exit 0</span>

<span class="c1"># ==========================================================</span>
<span class="c1"># Regles de: xarxa_local-(R/F)-xarxa_externa</span>
<span class="c1">#</span>
<span class="c1"># LOCAL_LAN ---(em1)Router/Firewall(wlan0)-- PUBLIC_LAN</span>
<span class="c1">#               |</span>
<span class="c1">#               DMZ (em1)</span>
<span class="c1"># ========================================================</span>

<span class="c1"># de la lan no accedir al router/fireall, excepte ssh, telnet i daytime</span>
iptables -A INPUT -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">22</span> -j ACCEPT
iptables -A INPUT -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">23</span> -j ACCEPT
iptables -A INPUT -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">13</span> -j ACCEPT
iptables -A INPUT -s <span class="m">172</span>.16.100.0/24 -j DROP
<span class="c1">#exit 0</span>

<span class="c1"># de la lan NO es pot navegar,telnet,ssh a fora</span>
iptables -A FORWARD -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">80</span> -j DROP
iptables -A FORWARD -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">23</span> -j DROP
iptables -A FORWARD -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">22</span> -j DROP

<span class="c1"># de la lan acces al servidor web de la dmz: intranet</span>
iptables -A INPUT -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">80</span> -j ACCEPT
iptables -A INPUT -s <span class="m">172</span>.16.100.0/24 -p tcp --dport <span class="m">443</span> -j ACCEPT

<span class="c1"># de exterior acces ports 3081:3085 redirigits a servers dins dmz</span>
iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport <span class="m">3081</span> -j DNAT <span class="se">\</span>
                                        --to <span class="m">172</span>.32.1.11:81
iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport <span class="m">3082</span> -j DNAT <span class="se">\</span>
                                        --to <span class="m">172</span>.32.1.11:82
iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport <span class="m">3083</span> -j DNAT <span class="se">\</span>
                                        --to <span class="m">172</span>.32.1.11:83
iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport <span class="m">3084</span> -j DNAT <span class="se">\</span>
                                        --to <span class="m">172</span>.32.1.11:84
iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport <span class="m">3085</span> -j DNAT <span class="se">\</span>
                                        --to <span class="m">172</span>.32.1.11:85

<span class="c1"># des de exteriors ports 3022:3025 redirigits a ssh host de la lan</span>
iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport <span class="m">3022</span> -j DNAT <span class="se">\</span>
                                        --to <span class="m">172</span>.16.100.11:22
iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport <span class="m">3023</span> -j DNAT <span class="se">\</span>
                                        --to <span class="m">172</span>.16.100.12:22
iptables -t nat -A PREROUTING -i wlan0 -p tcp --dport <span class="m">3024</span> -j DNAT <span class="se">\</span>
                                        --to <span class="m">172</span>.16.100.13:22
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../backups/rsync/" class="md-footer__link md-footer__link--prev" aria-label="Previous: rsync" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              rsync
            </div>
          </div>
        </a>
      
      
        
        <a href="../../../sistemas/Actualizar_hora_sys_o_bios/" class="md-footer__link md-footer__link--next" aria-label="Next: Gestionar Hora" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Gestionar Hora
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.01824240.min.js"}</script>
    
    
      <script src="../../../assets/javascripts/bundle.ff0eccb3.min.js"></script>
      
    
  </body>
</html>