



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="http://docs.jorgepastorr.tk:50022/administracion/server-correo/">
      
      
        <meta name="author" content="Jorge Pastor">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Servidor Correo - Apuntes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#servidor-correo" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://docs.jorgepastorr.tk:50022" title="Apuntes" aria-label="Apuntes" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Apuntes
            </span>
            <span class="md-header-nav__topic">
              
                Servidor Correo
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/jorgepastorr/apuntes/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    jorgepastorr/apuntes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://docs.jorgepastorr.tk:50022" title="Apuntes" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Apuntes
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/jorgepastorr/apuntes/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    jorgepastorr/apuntes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Apuntes Jorgepastorr" class="md-nav__link">
      Apuntes Jorgepastorr
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Administracion
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Administracion
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Configurar_pantallas_manualmente/" title="Configurar pantallas manualmente" class="md-nav__link">
      Configurar pantallas manualmente
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Debian_hostname_dinamico/" title="Debian hostname dinamico" class="md-nav__link">
      Debian hostname dinamico
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Mutt/" title="Que es mutt?" class="md-nav__link">
      Que es mutt?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Procesos/" title="Procesos" class="md-nav__link">
      Procesos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Resetear_la_password_root/" title="Resetear la password root." class="md-nav__link">
      Resetear la password root.
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Vim/" title="Vim atajos básicos" class="md-nav__link">
      Vim atajos básicos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../awk/" title="Uso básico de AWK" class="md-nav__link">
      Uso básico de AWK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../freeipa/" title="FreeIpa" class="md-nav__link">
      FreeIpa
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../instalar_webmin/" title="instalar webmin" class="md-nav__link">
      instalar webmin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../per/" title="PER" class="md-nav__link">
      PER
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../permisos_avanzados/" title="Permisos avanzados" class="md-nav__link">
      Permisos avanzados
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../samba/" title="Samba" class="md-nav__link">
      Samba
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Servidor Correo
      </label>
    
    <a href="./" title="Servidor Correo" class="md-nav__link md-nav__link--active">
      Servidor Correo
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#componentes" class="md-nav__link">
    Componentes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funcionamiento" class="md-nav__link">
    Funcionamiento
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurar-dns" class="md-nav__link">
    Configurar DNS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resolucion-directa-tipo-a-y-mx" class="md-nav__link">
    Resolución directa tipo A y MX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolucion-inversa-tipo-ptr" class="md-nav__link">
    Resolución inversa tipo PTR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobaciones-dns" class="md-nav__link">
    Comprobaciones DNS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisitos" class="md-nav__link">
    Prerequisitos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-basica" class="md-nav__link">
    Configuración básica
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion-de-postfix" class="md-nav__link">
    Instalación de postfix
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compruebo-funcionamiento-postfix" class="md-nav__link">
    Compruebo funcionamiento postfix
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalacion-dovecot" class="md-nav__link">
    Instalación Dovecot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobar-funcionamiento" class="md-nav__link">
    Comprobar funcionamiento
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-cifrada-sasl-tls" class="md-nav__link">
    Configuración cifrada SASL + TLS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generar-llaves" class="md-nav__link">
    generar llaves
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conf-postfix" class="md-nav__link">
    Conf postfix
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maincf" class="md-nav__link">
    Main.cf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mastercf" class="md-nav__link">
    Master.cf
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conf-dovecot" class="md-nav__link">
    Conf dovecot
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dovecotconf" class="md-nav__link">
    dovecot.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-authconf" class="md-nav__link">
    10-auth.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-mailconf" class="md-nav__link">
    10-mail.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-masterconf" class="md-nav__link">
    10-master.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-sslconf" class="md-nav__link">
    10-ssl.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-pop3conf" class="md-nav__link">
    20-pop3.conf
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opcional-seguridad" class="md-nav__link">
    Opcional seguridad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobar-funcionamiento_1" class="md-nav__link">
    Comprobar funcionamiento
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../server-mensajeria/" title="Server mensajeria instantanea" class="md-nav__link">
      Server mensajeria instantanea
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ssh/" title="ssh" class="md-nav__link">
      ssh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sudo/" title="sudo" class="md-nav__link">
      sudo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../umask/" title="umask" class="md-nav__link">
      umask
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../usuarios/" title="Usuarios" class="md-nav__link">
      Usuarios
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vnc/" title="vnc" class="md-nav__link">
      vnc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../webdav/" title="webdav" class="md-nav__link">
      webdav
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-21" type="checkbox" id="nav-2-21">
    
    <label class="md-nav__link" for="nav-2-21">
      Ldap
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-21">
        Ldap
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ldap/Ldap-Samba-Hostpam/" title="Ldap - Samba - Hostpam" class="md-nav__link">
      Ldap - Samba - Hostpam
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ldap/acl_ejercicios/" title="Acl ejercicios" class="md-nav__link">
      Acl ejercicios
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ldap/host-kerberos-con-ldap/" title="Instalación host ldap-kerberos" class="md-nav__link">
      Instalación host  ldap-kerberos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ldap/ldap/" title="ldap" class="md-nav__link">
      ldap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-22" type="checkbox" id="nav-2-22">
    
    <label class="md-nav__link" for="nav-2-22">
      Pxe
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-22">
        Pxe
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../pxe/Servidor-pxe-con-rapberry/" title="Servidor pxe con rapberry" class="md-nav__link">
      Servidor pxe con rapberry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pxe/guiapxe-fedora/" title="Guiapxe fedora" class="md-nav__link">
      Guiapxe fedora
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-23" type="checkbox" id="nav-2-23">
    
    <label class="md-nav__link" for="nav-2-23">
      Redes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-23">
        Redes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../redes/apuntes-xarxa/" title="APUNTS DE XARXES" class="md-nav__link">
      APUNTS DE XARXES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../redes/comandos_router_switch/" title="Configuració de Routers" class="md-nav__link">
      Configuració de Routers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../redes/haproxy/" title="Haproxy" class="md-nav__link">
      Haproxy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../redes/redes2/" title="Redes2" class="md-nav__link">
      Redes2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Auditoria
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Auditoria
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../auditoria/apuntes_hacking/" title="Haking ético" class="md-nav__link">
      Haking ético
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Bases datos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Bases datos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      Mongo
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        Mongo
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bases_datos/mongo/Mongo/" title="Mongo" class="md-nav__link">
      Mongo
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Postgres
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Postgres
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../bases_datos/postgres/bases/" title="Postgres" class="md-nav__link">
      Postgres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../bases_datos/postgres/modificaciones/" title="Modificación tablas" class="md-nav__link">
      Modificación tablas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../bases_datos/postgres/plpgsql/" title="Plpgsql" class="md-nav__link">
      Plpgsql
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../bases_datos/postgres/postgresql-intalacion/" title="Postgresql intalacion" class="md-nav__link">
      Postgresql intalacion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Curiosidades
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Curiosidades
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../curiosidades/Lanzador_aplicaciones_en_gnome/" title="Lanzador aplicaciones en gnome" class="md-nav__link">
      Lanzador aplicaciones en gnome
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../curiosidades/cambiar_color_promp_terminal/" title="Cambiar color promp terminal" class="md-nav__link">
      Cambiar color promp terminal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../curiosidades/conky/" title="conky" class="md-nav__link">
      conky
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../curiosidades/openbox/" title="Openbox" class="md-nav__link">
      Openbox
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../curiosidades/qbit/" title="Qbit" class="md-nav__link">
      Qbit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../curiosidades/tmux/" title="Tmux" class="md-nav__link">
      Tmux
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Desatendidas
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Desatendidas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../desatendidas/" title="Desatendidas" class="md-nav__link">
      Desatendidas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../desatendidas/Instalacion-desatendida-debian/" title="Instalacion desatendida debian" class="md-nav__link">
      Instalacion desatendida debian
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../desatendidas/desatendida-windows/" title="Desatendida windows" class="md-nav__link">
      Desatendida windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../desatendidas/kikstart/" title="Kikstart" class="md-nav__link">
      Kikstart
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Generar doc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Generar doc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../generar_doc/docsify/" title="Docsify" class="md-nav__link">
      Docsify
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../generar_doc/remark/" title="Remark" class="md-nav__link">
      Remark
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Lenguajes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Lenguajes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/Fundamentos_php/" title="Fundamentos php" class="md-nav__link">
      Fundamentos php
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/Shell/" title="Shell" class="md-nav__link">
      Shell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      Python3
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        Python3
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/Apuntes-Metodos/" title="Métodos de colecciones" class="md-nav__link">
      Métodos de colecciones
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-Funcionalidades_avanzadas/" title="apuntes Funcionalidades avanzadas" class="md-nav__link">
      apuntes Funcionalidades avanzadas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-Herencia/" title="Herencias" class="md-nav__link">
      Herencias
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-distribucion/" title="Distribución" class="md-nav__link">
      Distribución
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-documentacion/" title="Documentación" class="md-nav__link">
      Documentación
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-ficheros/" title="Apuntes ficheros" class="md-nav__link">
      Apuntes ficheros
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-fundamento/" title="Python fundamentos" class="md-nav__link">
      Python fundamentos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-modulos/" title="Módulos" class="md-nav__link">
      Módulos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-orientado-objetos/" title="Orientado a objetos" class="md-nav__link">
      Orientado a objetos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-test/" title="Test" class="md-nav__link">
      Test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes-tkinter/" title="Tkinter" class="md-nav__link">
      Tkinter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/apuntes_bases/" title="Apuntes bases" class="md-nav__link">
      Apuntes bases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lenguajes/python3/argparse/" title="Argparse" class="md-nav__link">
      Argparse
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Seguridad
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Seguridad
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/Certificados-Digitales/" title="Certificados Digitales" class="md-nav__link">
      Certificados Digitales
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/Kerberos/" title="Kerberos" class="md-nav__link">
      Kerberos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/OpenVpn/" title="OpenVpn" class="md-nav__link">
      OpenVpn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/The-crazy-thing/" title="The crazy thing!" class="md-nav__link">
      The crazy thing!
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/TunelSSH/" title="Tunel SSH" class="md-nav__link">
      Tunel SSH
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/gpg/" title="GPG" class="md-nav__link">
      GPG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/lvm/" title="Lvm logical volum manager" class="md-nav__link">
      Lvm logical volum manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/practica-ssl-tls/" title="Practica ssl tls" class="md-nav__link">
      Practica ssl tls
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/raid/" title="Raid" class="md-nav__link">
      Raid
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-10" type="checkbox" id="nav-9-10">
    
    <label class="md-nav__link" for="nav-9-10">
      Backups
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-10">
        Backups
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/backups/Borg_basico/" title="Borg básico" class="md-nav__link">
      Borg básico
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/backups/Tar/" title="Tar" class="md-nav__link">
      Tar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/backups/rdiff-backup/" title="rdiff-backup" class="md-nav__link">
      rdiff-backup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/backups/rsync/" title="rsync" class="md-nav__link">
      rsync
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9-11" type="checkbox" id="nav-9-11">
    
    <label class="md-nav__link" for="nav-9-11">
      Cortafuegos
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-9-11">
        Cortafuegos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../seguridad/cortafuegos/Iptables/" title="Iptables" class="md-nav__link">
      Iptables
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Sistemas
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Sistemas
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/Actualizar_hora_sys_o_bios/" title="Gestionar Hora" class="md-nav__link">
      Gestionar Hora
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/Arranque-del-sistema/" title="Arranque del sistema" class="md-nav__link">
      Arranque del sistema
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/Eliminar_contrase%C3%B1a_windows/" title="Eliminar contraseña windows" class="md-nav__link">
      Eliminar contraseña windows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/Estructura_de_directorios/" title="Estructura de directorios" class="md-nav__link">
      Estructura de directorios
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/Logs_journalctl/" title="Logs" class="md-nav__link">
      Logs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/Systemd/" title="Systemd" class="md-nav__link">
      Systemd
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/chroot/" title="Chroot" class="md-nav__link">
      Chroot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/disco/" title="Disco" class="md-nav__link">
      Disco
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/gestores_de_paquetes/" title="Gestores de paquetes" class="md-nav__link">
      Gestores de paquetes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/getenforce/" title="getenforce" class="md-nav__link">
      getenforce
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/grub/" title="Grub" class="md-nav__link">
      Grub
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/home/" title="Cambiar /home" class="md-nav__link">
      Cambiar /home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/ip_est%C3%A1tica/" title="ip estática raspberry" class="md-nav__link">
      ip estática raspberry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/pam/" title="Pam" class="md-nav__link">
      Pam
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/raid/" title="Raid" class="md-nav__link">
      Raid
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/xinetd/" title="xinetd" class="md-nav__link">
      xinetd
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10-17" type="checkbox" id="nav-10-17">
    
    <label class="md-nav__link" for="nav-10-17">
      Automatizacion
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-10-17">
        Automatizacion
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/automatizacion/ansible/" title="Ansible" class="md-nav__link">
      Ansible
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sistemas/automatizacion/tareas_programadas/" title="Tareas Programadas" class="md-nav__link">
      Tareas Programadas
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Virtualizacion
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Virtualizacion
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/Docker-basico/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/Lxc/" title="LXC y LXD" class="md-nav__link">
      LXC y LXD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/Vagrant/" title="Vagrant" class="md-nav__link">
      Vagrant
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/kubernetes/" title="Kubernetes" class="md-nav__link">
      Kubernetes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/swarm/" title="Swarm" class="md-nav__link">
      Swarm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-6" type="checkbox" id="nav-11-6">
    
    <label class="md-nav__link" for="nav-11-6">
      Virt manager
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-6">
        Virt manager
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/virt-manager/Backing_chain/" title="Backing_chain" class="md-nav__link">
      Backing_chain
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/virt-manager/Clonar/" title="Clonar de virtual a físico y de físico a virtual." class="md-nav__link">
      Clonar de virtual a físico y de físico a virtual.
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/virt-manager/Instalacion_de_virtualizacion_fedora/" title="Instalación de virtualización fedora" class="md-nav__link">
      Instalación de virtualización fedora
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/virt-manager/acceder_consola_desde_virsh/" title="acceder consola desde virsh" class="md-nav__link">
      acceder consola desde virsh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/virt-manager/crear_red_aislada/" title="Crear red aislada" class="md-nav__link">
      Crear red aislada
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../virtualizacion/virt-manager/instalar_maquina_virtual_virt-install/" title="virt" class="md-nav__link">
      virt
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#componentes" class="md-nav__link">
    Componentes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funcionamiento" class="md-nav__link">
    Funcionamiento
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configurar-dns" class="md-nav__link">
    Configurar DNS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resolucion-directa-tipo-a-y-mx" class="md-nav__link">
    Resolución directa tipo A y MX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resolucion-inversa-tipo-ptr" class="md-nav__link">
    Resolución inversa tipo PTR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobaciones-dns" class="md-nav__link">
    Comprobaciones DNS
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisitos" class="md-nav__link">
    Prerequisitos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-basica" class="md-nav__link">
    Configuración básica
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#instalacion-de-postfix" class="md-nav__link">
    Instalación de postfix
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compruebo-funcionamiento-postfix" class="md-nav__link">
    Compruebo funcionamiento postfix
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instalacion-dovecot" class="md-nav__link">
    Instalación Dovecot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobar-funcionamiento" class="md-nav__link">
    Comprobar funcionamiento
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuracion-cifrada-sasl-tls" class="md-nav__link">
    Configuración cifrada SASL + TLS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generar-llaves" class="md-nav__link">
    generar llaves
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conf-postfix" class="md-nav__link">
    Conf postfix
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#maincf" class="md-nav__link">
    Main.cf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mastercf" class="md-nav__link">
    Master.cf
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conf-dovecot" class="md-nav__link">
    Conf dovecot
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dovecotconf" class="md-nav__link">
    dovecot.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-authconf" class="md-nav__link">
    10-auth.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-mailconf" class="md-nav__link">
    10-mail.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-masterconf" class="md-nav__link">
    10-master.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-sslconf" class="md-nav__link">
    10-ssl.conf
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-pop3conf" class="md-nav__link">
    20-pop3.conf
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opcional-seguridad" class="md-nav__link">
    Opcional seguridad
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprobar-funcionamiento_1" class="md-nav__link">
    Comprobar funcionamiento
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/jorgepastorr/apuntes/edit/master/docs/administracion/server-correo.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="servidor-correo">Servidor Correo</h1>
<p>Para crear este servidor de correo estoy utilizando Postfix, Maildir y Dovecot como cliente utilizo Thunderbird. Este servidor se esta configurando en una maquina virtual Debian10 Buster sobre VirtManager con una configuración de red Bridge sobre la targeta del Host.</p>
<div class="codehilite"><pre><span></span><code>                 +--------+                +--------+
                 <span class="p">|</span>        <span class="p">|</span>                <span class="p">|</span>        <span class="p">|</span>
                 <span class="p">|</span>        <span class="p">|</span>                <span class="p">|</span>        <span class="p">|</span>
  Internet       <span class="p">|</span>        <span class="p">|</span>                <span class="p">|</span>        <span class="p">|</span>
   +-----------&gt; <span class="p">|</span>  MTA   <span class="p">|</span>                <span class="p">|</span>  MTA   <span class="p">|</span>          Servidor
   <span class="p">|</span>             <span class="p">|</span>        <span class="p">|</span>                <span class="p">|</span>        <span class="p">|</span>          pop3/imap
   <span class="p">|</span>             <span class="p">|</span>        <span class="p">|</span>     Internet   <span class="p">|</span>        <span class="p">|</span>          +------+
   <span class="p">|</span>             <span class="p">|</span>        <span class="p">|</span>  +-----------&gt; <span class="p">|</span>        +-------&gt;  <span class="p">|</span> MDA  <span class="p">|</span>
+--+-+           +--------+                +--------+          +---+--+     +----+
<span class="p">|</span>    <span class="p">|</span>          Servidor MTP               Servidor MTP            <span class="p">|</span>        <span class="p">|</span>    <span class="p">|</span>
<span class="p">|</span>    <span class="p">|</span>                                                             <span class="p">|</span>        <span class="p">|</span>MUA <span class="p">|</span>
<span class="p">|</span>MUA <span class="p">|</span>                                                             <span class="p">|</span>        <span class="p">|</span>    <span class="p">|</span>
+----+                                                             +----&gt;   +----+

 Cliente correo                                                          Cliente correo
 electronico                                                             electronico
</code></pre></div>

<h2 id="componentes">Componentes</h2>
<p>MUA ( Mail User Agent ) Thunderbird</p>
<p>MTA ( Mail transfer agent ) Postfix</p>
<ul>
<li>postfix transfire correo desde un servidor a otro mediante SMTP</li>
</ul>
<p>MDA ( Mail Delivery Agent ) Devecot</p>
<ul>
<li>Devocot reparte los correos de tu servidor a los usuarios a traves de un cliente en este caso thunderbird</li>
</ul>
<p>POP3/IMAP protocolos de acceso al buzon de correo</p>
<ul>
<li>
<p>IMAP accede remotamente al buzon del servidor de correo electronico para leer la correspondencia remotamente</p>
</li>
<li>
<p>POP3 descarga el buzon de correo del servidor, para posteriormente leer el correo de forma local</p>
</li>
</ul>
<h2 id="funcionamiento">Funcionamiento</h2>
<p>Para enviar un correo se utilizax  un MUA que lo transfirere a un servidor MTA con el protocolo SMTP</p>
<p>El MTA recibe el correo y lo envia al MTA del destinatario utilizando SMTP</p>
<p>El MTA destinatario almacena el correo en el buzon correspondiente, funcion que en algunos casos realiza un programa especifico denominado MDA</p>
<p>El mensage permanece en el buzon hasta que el destinatario utiliza su MUA para acceder al buzon mediante los protocolos POP o IMAP</p>
<h2 id="configurar-dns">Configurar DNS</h2>
<p>Es necesario configurar un DNS para poder resolver las peticiones de  correo en este documento el servidor de correo se encuentra en <code>192.168.88.13</code> y el dns en <code>192.168.88.4</code> donde la LAN es <code>192.168.88.0/24</code>. </p>
<p>A la hora de instalar nuestro servidor de correo, tendremos que crear los siguientes registros en el DNS:</p>
<ul>
<li>Un registro de tipo A que apunte a la dirección del servidor de correo.</li>
<li>Un registro de tipo PTR, para que funcione la resolución inversa  (necesaria por algunos sistemas para controlar el envío de SPAM por  servidores SMTP.</li>
<li>Un registro de tipo MX con la prioridad que deseemos, y que apunte al equipo servidor de correo de nuestro dominio.</li>
</ul>
<div class="codehilite"><pre><span></span><code>cat /etc/bind/named.conf.local 
...
<span class="c1"># especificacion de zonas</span>

zone <span class="s2">&quot;mymail.com&quot;</span> <span class="o">{</span>
    <span class="nb">type</span> master<span class="p">;</span>
    file <span class="s2">&quot;db.mymail.com&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>

zone <span class="s2">&quot;88.168.192.in-addr.arpa&quot;</span> <span class="o">{</span>
    <span class="nb">type</span> master<span class="p">;</span>
    file <span class="s2">&quot;db.rev.mymail.com&quot;</span><span class="p">;</span>
<span class="o">}</span><span class="p">;</span>
</code></pre></div>

<h3 id="resolucion-directa-tipo-a-y-mx">Resolución directa tipo A y MX</h3>
<div class="codehilite"><pre><span></span><code>cat  /var/cache/bind/db.mymail.com
<span class="nv">$TTL</span>    <span class="m">3600</span>
@       IN      SOA     server.myail.com. root.mymail.com. <span class="o">(</span>
                   <span class="m">2020122001</span>           <span class="p">;</span> Serial
                         <span class="m">3600</span>           <span class="p">;</span> Refresh <span class="o">[</span>1h<span class="o">]</span>
                          <span class="m">600</span>           <span class="p">;</span> Retry   <span class="o">[</span>10m<span class="o">]</span>
                        <span class="m">86400</span>           <span class="p">;</span> Expire  <span class="o">[</span>1d<span class="o">]</span>
                          <span class="m">600</span> <span class="o">)</span>         <span class="p">;</span> Negative Cache TTL <span class="o">[</span>1h<span class="o">]</span>
<span class="p">;</span>
@       IN      NS      server.mymail.com.
mymail.com.      IN      MX      <span class="m">10</span> correo

server      IN      A       <span class="m">192</span>.168.88.4
torre       IN      A       <span class="m">192</span>.168.88.2
portatil    IN      A       <span class="m">192</span>.168.88.3
correo      IN      A       <span class="m">192</span>.168.88.13
</code></pre></div>

<h3 id="resolucion-inversa-tipo-ptr">Resolución inversa tipo PTR</h3>
<div class="codehilite"><pre><span></span><code>cat  /var/cache/bind/db.rev.mymail.com
<span class="nv">$TTL</span>    <span class="m">3600</span>
@       IN      SOA     server.mymail.com. root.mymail.com. <span class="o">(</span>
                   <span class="m">2020122001</span>           <span class="p">;</span> Serial
                         <span class="m">3600</span>           <span class="p">;</span> Refresh <span class="o">[</span>1h<span class="o">]</span>
                          <span class="m">600</span>           <span class="p">;</span> Retry   <span class="o">[</span>10m<span class="o">]</span>
                        <span class="m">86400</span>           <span class="p">;</span> Expire  <span class="o">[</span>1d<span class="o">]</span>
                          <span class="m">600</span> <span class="o">)</span>         <span class="p">;</span> Negative Cache TTL <span class="o">[</span>1h<span class="o">]</span>
<span class="p">;</span>
    IN      NS      server.mymail.com.

<span class="m">4</span>   IN      PTR       server.mymail.com.
<span class="m">3</span>   IN      PTR       portatil.mymail.com.
<span class="m">2</span>   IN      PTR       torre.mymail.com.
<span class="m">13</span>  IN      PTR       correo.mymail.com.
</code></pre></div>

<h3 id="comprobaciones-dns">Comprobaciones DNS</h3>
<p>Comprobar que la sintaxis es correcta</p>
<div class="codehilite"><pre><span></span><code>sudo named-checkzone <span class="m">88</span>.168.192.in-addr.arpa /var/cache/bind/db.rev.mymail.com 
zone <span class="m">88</span>.168.192.in-addr.arpa/IN: loaded serial <span class="m">2020122001</span>
OK

sudo named-checkzone mymail.com /var/cache/bind/db.mymail.com 
zone mymail.com/IN: loaded serial <span class="m">2020122001</span>
OK
</code></pre></div>

<p>Comprobar la resolución de dominio</p>
<div class="codehilite"><pre><span></span><code>nslookup correo.mymail.com
Server:     <span class="m">192</span>.168.88.4
Address:    <span class="m">192</span>.168.88.4#53

Name:   correo.mymail.com
Address: <span class="m">192</span>.168.88.13

nslookup <span class="m">192</span>.168.88.13
<span class="m">13</span>.88.168.192.in-addr.arpa  <span class="nv">name</span> <span class="o">=</span> correo.mymail.com.
</code></pre></div>

<h2 id="prerequisitos">Prerequisitos</h2>
<p>Añadir ip estatica al servidor de correo e indicar donde esta el DNS</p>
<div class="codehilite"><pre><span></span><code>cat /etc/network/interfaces
<span class="c1"># This file describes the network interfaces available on your system</span>
<span class="c1"># and how to activate them. For more information, see interfaces(5).</span>

<span class="nb">source</span> /etc/network/interfaces.d/*

<span class="c1"># The loopback network interface</span>
auto lo
iface lo inet loopback

auto enp1s0
iface enp1s0 inet static 
    address <span class="m">192</span>.168.88.13
    netmask <span class="m">255</span>.255.255.0
    gateway <span class="m">192</span>.168.88.1
</code></pre></div>

<div class="codehilite"><pre><span></span><code>cat /etc/resolv.conf 
search mymail.com
nameserver <span class="m">192</span>.168.88.4
</code></pre></div>

<p>Las <strong>cuentas de usuario</strong> de correo, realmente  son usuarios creados en el servidor de correo, asi que creo un par de usuarios para pruebas.</p>
<div class="codehilite"><pre><span></span><code>root@debmail:~# useradd compras -m
root@debmail:~# useradd ventas -m
root@debmail:~# passwd compras
New password: 
Retype new password: 
passwd: password updated successfully
root@debmail:~# passwd ventas
New password: 
Retype new password: 
passwd: password updated successfully
</code></pre></div>

<p>Acceso puertos al firewall</p>
<p>smtp 25</p>
<p>imap 143</p>
<p>imaps 993</p>
<p>smtps 465</p>
<p>submission 587</p>
<p>pop3 110</p>
<p>syslog-ng</p>
<h2 id="configuracion-basica">Configuración básica</h2>
<p>Esta configuración aportara un servidor de correo inseguro donde las contraseñas biajaran en texto plano, no se debe utilizar nunca este tipo de  configuración a no ser vque sea exclusivo para pruebas y entendimiento.</p>
<h3 id="instalacion-de-postfix">Instalación de postfix</h3>
<p>En la instalación de postfix pide indicar que tipo de servicio quieres configurar y el dominio: </p>
<ul>
<li>
<p><code>sitio de interner, servidor local...</code> en este caso indicamos sitio de internet, porque quiero que se comunique con otros mx. </p>
</li>
<li>
<p>Si queremos que nuestras direcciones sean <code>example@mymail.com</code>  deberemos indicar <code>mymail.com</code></p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code>sudo apt install postfix
sudo postconf mail_version
<span class="nv">mail_version</span> <span class="o">=</span> <span class="m">3</span>.4.14
</code></pre></div>

<p>De momento nos aseguramos de algunos parametros de la  configuración</p>
<div class="codehilite"><pre><span></span><code>vim /etc/postfix/main.cf
...
<span class="c1"># my dominio completo</span>
<span class="nv">myhostname</span> <span class="o">=</span> correo.mymail.com
<span class="nv">alias_maps</span> <span class="o">=</span> hash:/etc/aliases
<span class="nv">alias_database</span> <span class="o">=</span> hash:/etc/aliases

<span class="c1"># my origin a de tener my dominio</span>
<span class="nv">myorigin</span> <span class="o">=</span> /etc/mailname

<span class="c1"># my destination añadir dominio mymail.com en mi caso</span>
<span class="nv">mydestination</span> <span class="o">=</span> <span class="nv">$myhostname</span>, mymail.com, localhost, localhost.localdomain, locall
host
<span class="nv">relayhost</span> <span class="o">=</span>

<span class="c1"># añado la red local en la que va a trabajar</span>
<span class="nv">mynetworks</span> <span class="o">=</span> <span class="m">192</span>.168.88.0/24 <span class="m">127</span>.0.0.0/8 <span class="o">[</span>::ffff:127.0.0.0<span class="o">]</span>/104 <span class="o">[</span>::1<span class="o">]</span>/128
<span class="nv">mailbox_size_limit</span> <span class="o">=</span> <span class="m">0</span>
<span class="nv">recipient_delimiter</span> <span class="o">=</span> +

<span class="c1"># me aseguro que trabaje en todas las interfaces y protocolos</span>
<span class="nv">inet_interfaces</span> <span class="o">=</span> all
<span class="nv">inet_protocols</span> <span class="o">=</span> all

<span class="c1"># añado maildir como lugar donde se guardaran los correos</span>
<span class="nv">home_mailbox</span> <span class="o">=</span> Maildir/
</code></pre></div>

<blockquote>
<p><strong>Nota</strong>: La instrucción <code>home_mailbox = Maildir/</code>  cambia el lugar donde se almacenan los correos, por defecto es <code>/var/mail</code> y con maildir se almacena en el home de cada usuaro en el directorio <code>~/Maildir</code></p>
<p>Esta instrucción hace un poco mas eficiente el servicio.</p>
</blockquote>
<p>Me aseguro que el archivo mailname este mi dominio</p>
<div class="codehilite"><pre><span></span><code>cat /etc/mailname 
mymail.com
</code></pre></div>

<p>Recargo configuración con los nuevos cambios y visualizo que esten en orden</p>
<div class="codehilite"><pre><span></span><code>root@debmail:~# systemctl reload postfix
root@debmail:~# postconf -n

<span class="nv">alias_database</span> <span class="o">=</span> hash:/etc/aliases
<span class="nv">alias_maps</span> <span class="o">=</span> hash:/etc/aliases
<span class="nv">append_dot_mydomain</span> <span class="o">=</span> no
<span class="nv">biff</span> <span class="o">=</span> no
<span class="nv">compatibility_level</span> <span class="o">=</span> <span class="m">2</span>
<span class="nv">home_mailbox</span> <span class="o">=</span> Maildir/
<span class="nv">inet_interfaces</span> <span class="o">=</span> all
<span class="nv">inet_protocols</span> <span class="o">=</span> all
<span class="nv">mailbox_size_limit</span> <span class="o">=</span> <span class="m">0</span>
<span class="nv">mydestination</span> <span class="o">=</span> <span class="nv">$myhostname</span>, mymail.com, localhost, localhost.localdomain, localhost
<span class="nv">myhostname</span> <span class="o">=</span> correo.mymail.com
<span class="nv">mynetworks</span> <span class="o">=</span> <span class="m">192</span>.168.88.0/24 <span class="m">127</span>.0.0.0/8 <span class="o">[</span>::ffff:127.0.0.0<span class="o">]</span>/104 <span class="o">[</span>::1<span class="o">]</span>/128
<span class="nv">myorigin</span> <span class="o">=</span> /etc/mailname
<span class="nv">readme_directory</span> <span class="o">=</span> no
<span class="nv">recipient_delimiter</span> <span class="o">=</span> +
<span class="nv">relayhost</span> <span class="o">=</span>
<span class="nv">smtp_tls_session_cache_database</span> <span class="o">=</span> btree:<span class="si">${</span><span class="nv">data_directory</span><span class="si">}</span>/smtp_scache
<span class="nv">smtpd_banner</span> <span class="o">=</span> <span class="nv">$myhostname</span> ESMTP <span class="nv">$mail_name</span> <span class="o">(</span>Debian/GNU<span class="o">)</span>
<span class="nv">smtpd_relay_restrictions</span> <span class="o">=</span> permit_mynetworks permit_sasl_authenticated defer_unauth_destination
<span class="nv">smtpd_tls_cert_file</span> <span class="o">=</span> /etc/ssl/certs/ssl-cert-snakeoil.pem
<span class="nv">smtpd_tls_key_file</span> <span class="o">=</span> /etc/ssl/private/ssl-cert-snakeoil.key
<span class="nv">smtpd_tls_session_cache_database</span> <span class="o">=</span> btree:<span class="si">${</span><span class="nv">data_directory</span><span class="si">}</span>/smtpd_scache
<span class="nv">smtpd_use_tls</span> <span class="o">=</span> yes
</code></pre></div>

<h4 id="compruebo-funcionamiento-postfix">Compruebo funcionamiento postfix</h4>
<p>Primero compruebo que el puerto de smtp(25) este activo, y que desde otro host pueda  aceder por el mismo.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># compruebo con netstat puerto abierto</span>
root@debmail:~# netstat -nlpt4
Active Internet connections <span class="o">(</span>only servers<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name             
tcp        <span class="m">0</span>      <span class="m">0</span> <span class="m">0</span>.0.0.0:25              <span class="m">0</span>.0.0.0:*               LISTEN      <span class="m">10270</span>/master        

<span class="c1"># establezco una conexión desde otro host al server</span>
pi@raspberrypi:~ $ nc -zv <span class="m">192</span>.168.88.13 <span class="m">25</span>
Connection to <span class="m">192</span>.168.88.13 <span class="m">25</span> port <span class="o">[</span>tcp/smtp<span class="o">]</span> succeeded!
</code></pre></div>

<p>Ahora compruebo que puedo enviar mensajes y recibirlos. </p>
<p>Instalo <code>mailutils</code> para poder mandar mails desde consola con <code>sendmail</code> </p>
<div class="codehilite"><pre><span></span><code>sudo apt install mailutils

<span class="c1"># mando un mail simple desde root al usuario compras</span>
<span class="nb">echo</span> <span class="s2">&quot;Subject: Correo Maildir 1&quot;</span> <span class="p">|</span> sendmail compras@mymail.com

<span class="c1"># los mails se almacenan en:</span>
ls /home/compras/Maildir/
cur  new  tmp

<span class="c1"># compruebo la llegada del mail al usuario compras</span>
cat /home/compras/Maildir/new/1609175551.Vfe01I20cc3M685651.debmail 
Return-Path: &lt;root@mymail.com&gt;
X-Original-To: compras@mymail.com
Delivered-To: compras@mymail.com
Received: by correo.mymail.com <span class="o">(</span>Postfix, from userid <span class="m">0</span><span class="o">)</span>
        id 5B0B020CC1<span class="p">;</span> Mon, <span class="m">28</span> Dec <span class="m">2020</span> <span class="m">12</span>:12:31 -0500 <span class="o">(</span>EST<span class="o">)</span>
Subject: Correo Maildir <span class="m">1</span>
Message-Id: &lt;<span class="m">20201228171231</span>.5B0B020CC1@correo.mymail.com&gt;
Date: Mon, <span class="m">28</span> Dec <span class="m">2020</span> <span class="m">12</span>:12:31 -0500 <span class="o">(</span>EST<span class="o">)</span>
From: root &lt;root@mymail.com&gt;
</code></pre></div>

<p>En este punto podemos mandar mails desde terminal.</p>
<h3 id="instalacion-dovecot">Instalación Dovecot</h3>
<p>Instalamos Dovecot para que haga de MUA y acceder desde un cliente tipo thunderbird, etc...</p>
<div class="codehilite"><pre><span></span><code>apt install dovecot-core dovecot-imapd dovecot-pop3d
</code></pre></div>

<p>En la configuración de autentificación, estamos configurando un server básico e inseguro solo para pruebas, así que habilitamos el texto plano en la autenticación.</p>
<div class="codehilite"><pre><span></span><code>vim /etc/dovecot/conf.d/10-auth.conf           

<span class="c1"># habilitamos el texto plano ( es muy inseguro !!!)</span>
<span class="nv">disable_plaintext_auth</span> <span class="o">=</span> no

<span class="c1"># Este formato recoge el usuario de user@dominio.com</span>
<span class="nv">auth_username_format</span> <span class="o">=</span> %Ln
</code></pre></div>

<p>Indicamos donde guardar la correspondencia, ya que por defecto utiliza mbox.</p>
<div class="codehilite"><pre><span></span><code>vim /etc/dovecot/conf.d/10-mail.conf     

<span class="c1"># directorio donde guardar la correspondencia</span>
<span class="nv">mail_location</span> <span class="o">=</span> maildir:~/Maildir
<span class="c1">#   mail_location = mbox:~/mail:INBOX=/var/mail/%u</span>
<span class="c1">#   mail_location = mbox:/var/mail/%d/%1n/%n:INDEX=/var/indexes/%d/%1n/%n</span>
<span class="c1">#mail_location = mbox:~/mail:INBOX=/var/mail/%u</span>

<span class="c1"># dar acceso al grupo mail, para las cuentas recien creadas.</span>
<span class="nv">mail_access_groups</span> <span class="o">=</span> mail
</code></pre></div>

<p>Para que clientesvcomo outlook o thunderbird funcionen bien con pop3 necesita descomentar el formato indicado</p>
<div class="codehilite"><pre><span></span><code>vim /etc/dovecot/conf.d/20-pop3.conf
<span class="nv">pop3_uidl_format</span> <span class="o">=</span> %08Xu%08Xv
</code></pre></div>

<p>Reiniciar servicio</p>
<div class="codehilite"><pre><span></span><code>systemctl reload dovecot
</code></pre></div>

<h3 id="comprobar-funcionamiento">Comprobar funcionamiento</h3>
<p>Para comprobar el servicio se tiene que instalar thunderbird y acceder al correo desde el cliente de momento no hay certificados  y la conexión es muy insegura pero el funcionamiento se puede probar.</p>
<h2 id="configuracion-cifrada-sasl-tls">Configuración cifrada SASL + TLS</h2>
<p>La configuración <strong>SASL</strong> + <strong>TLS</strong> (Simple  Authentication Security Layer with Transport Layer Security), se utiliza principalmente para autenticar a los usuarios, antes de que envíen  correo a un servidor externo. SASL maneja la autenticación y TLS se encarga de cifrar el contnido del mensaje.</p>
<h3 id="generar-llaves">generar llaves</h3>
<p>Si tubieramos un dominio público se podria generar unos certificados con LetsEncrypt o similar, pero al ser un entorno de pruebas nos gisamos nuestros propios certificados.</p>
<div class="codehilite"><pre><span></span><code>openssl genrsa -des3 -out mymail.key <span class="m">2048</span>

openssl req -new -key mymail.key -out mymail.csr
Enter pass phrase <span class="k">for</span> mymail.key:
Organizational Unit Name <span class="o">(</span>eg, section<span class="o">)</span> <span class="o">[]</span>:mymail
Common Name <span class="o">(</span>e.g. server FQDN or YOUR name<span class="o">)</span> <span class="o">[]</span>:*.mymail.com
Email Address <span class="o">[]</span>:webadmin@mymail.com

openssl x509 -req -days <span class="m">365</span> -in mymail.csr -signkey mymail.key -out mymail.crt

openssl rsa -in mymail.key -out mymail.key,nopass
mv mymail.key,nopass mymail.key

openssl req  -new -x509 -extensions v3_ca -keyout cakey.pem -out cacert.pem -days <span class="m">365</span>

<span class="c1"># una vez creados los movemos al directorio de ssl</span>
mv mymail.key /etc/ssl/private/
mv cakey.pem /etc/ssl/private/
mv mymail.crt /etc/ssl/certs/
mv cacrt.pem /etc/ssl/certs/
</code></pre></div>

<h3 id="conf-postfix">Conf postfix</h3>
<p>Respecto a la configuración de postfix anterior añadimos nuevos parametros para activar el sasl y el tls.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># usar certificados propios ---------------------</span>
sudo postconf -e <span class="s1">&#39;smtpd_tls_key_file = /etc/ssl/private/mymail.key&#39;</span>
sudo postconf -e <span class="s1">&#39;smtpd_tls_cert_file = /etc/ssl/certs/mymail.crt&#39;</span>
sudo postconf -e <span class="s1">&#39;smtpd_tls_CAfile = /etc/ssl/certs/cacrt.pem&#39;</span>

<span class="c1"># opciones de autenticación sasl -------------------</span>

sudo postconf -e <span class="s1">&#39;smtpd_sasl_auth_enable = yes&#39;</span>
<span class="c1"># comunicacion con dovecot</span>
sudo postconf -e <span class="s1">&#39;smtpd_sasl_type = dovecot&#39;</span>
sudo postconf -e <span class="s1">&#39;smtpd_sasl_path = private/auth&#39;</span>
<span class="c1"># no añadir dominio en la autenticacion del user</span>
sudo postconf -e <span class="s1">&#39;smtpd_sasl_local_domain =&#39;</span>
<span class="c1"># no permitir usuarios desconocidos ni contraseñas en texto plano</span>
sudo postconf -e <span class="s1">&#39;smtpd_sasl_security_options = noplaintext,noanonymous&#39;</span>
sudo postconf -e <span class="s1">&#39;smtpd_sasl_tls_security_options = $smtpd_sasl_security_options&#39;</span>
<span class="c1"># añade un separador especifico para los clientes Outlook</span>
sudo postconf -e <span class="s1">&#39;broken_sasl_auth_clients = yes&#39;</span>


sudo postconf -e <span class="s1">&#39;smtpd_recipient_restrictions = permit_sasl_authenticated,permit_mynetworks,reject_unauth_destination&#39;</span>

<span class="c1"># configuración tls ------------------------</span>
sudo postconf -e <span class="s1">&#39;smtpd_use_tls = yes&#39;</span>
sudo postconf -e <span class="s1">&#39;smtp_use_tls = yes&#39;</span>
<span class="c1"># solo admitir comunicación por tls</span>
sudo postconf -e <span class="s1">&#39;smtpd_tls_auth_only = no&#39;</span>
<span class="c1"># nivel de log </span>
sudo postconf -e <span class="s1">&#39;smtpd_tls_loglevel = 1&#39;</span>
<span class="c1"># incluir informacion de protocolo y nombre comun del cliente en el encabezado</span>
sudo postconf -e <span class="s1">&#39;smtpd_tls_received_header = yes&#39;</span>
<span class="c1"># por defecto la cache es de 300s aumentar a 1h</span>
sudo postconf -e <span class="s1">&#39;smtpd_tls_session_cache_timeout = 3600s&#39;</span>
</code></pre></div>

<p>Ademas hay que modificar manualmente el archivo master.cf</p>
<h4 id="maincf">Main.cf</h4>
<p>Ejemplo de archivo main.cf</p>
<div class="codehilite"><pre><span></span><code>cat /etc/postfix/main.cf

<span class="c1">#myorigin = /etc/mailname</span>
<span class="nv">smtpd_banner</span> <span class="o">=</span> <span class="nv">$myhostname</span> ESMTP <span class="nv">$mail_name</span> <span class="o">(</span>Debian/GNU<span class="o">)</span>
<span class="nv">biff</span> <span class="o">=</span> no
<span class="c1"># appending .domain is the MUA&#39;s job.</span>
<span class="nv">append_dot_mydomain</span> <span class="o">=</span> no

<span class="c1"># Uncomment the next line to generate &quot;delayed mail&quot; warnings</span>
<span class="c1">#delay_warning_time = 4h</span>

<span class="nv">readme_directory</span> <span class="o">=</span> no

<span class="c1"># See http://www.postfix.org/COMPATIBILITY_README.html -- default to 2 on</span>
<span class="c1"># fresh installs.</span>
<span class="nv">compatibility_level</span> <span class="o">=</span> <span class="m">2</span>

<span class="c1"># TLS parameters</span>
<span class="nv">smtpd_tls_auth_only</span> <span class="o">=</span> no
<span class="nv">smtpd_use_tls</span> <span class="o">=</span> yes
<span class="nv">smtp_use_tls</span> <span class="o">=</span> yes
<span class="nv">smtp_tls_note_starttls_offer</span> <span class="o">=</span> yes
<span class="nv">smtpd_tls_key_file</span> <span class="o">=</span> /etc/ssl/private/mymail.key
<span class="nv">smtpd_tls_cert_file</span> <span class="o">=</span> /etc/ssl/certs/mymail.crt
<span class="nv">smtpd_tls_CAfile</span> <span class="o">=</span> /etc/ssl/certs/cacrt.pem
<span class="nv">smtpd_tls_loglevel</span> <span class="o">=</span> <span class="m">1</span>

<span class="nv">smtpd_tls_received_header</span> <span class="o">=</span> yes
<span class="nv">smtpd_tls_session_cache_timeout</span> <span class="o">=</span> 3600s
<span class="nv">smtpd_tls_session_cache_database</span> <span class="o">=</span> btree:<span class="si">${</span><span class="nv">data_directory</span><span class="si">}</span>/smtpd_scache
<span class="nv">smtp_tls_session_cache_database</span> <span class="o">=</span> btree:<span class="si">${</span><span class="nv">data_directory</span><span class="si">}</span>/smtp_scache

<span class="c1"># See /usr/share/doc/postfix/TLS_README.gz in the postfix-doc package for</span>
<span class="c1"># information on enabling SSL in the smtp client.</span>

<span class="nv">smtpd_relay_restrictions</span> <span class="o">=</span> permit_mynetworks permit_sasl_authenticated defer_unauth_destination
<span class="nv">myhostname</span> <span class="o">=</span> correo.mymail.com
<span class="nv">alias_maps</span> <span class="o">=</span> hash:/etc/aliases
<span class="nv">alias_database</span> <span class="o">=</span> hash:/etc/aliases
<span class="nv">myorigin</span> <span class="o">=</span> /etc/mailname
<span class="nv">mydestination</span> <span class="o">=</span> <span class="nv">$myhostname</span>, mymail.com, localhost, localhost.localdomain, localhost
<span class="nv">relayhost</span> <span class="o">=</span> 
<span class="nv">mynetworks</span> <span class="o">=</span> <span class="m">192</span>.168.88.0/24 <span class="m">127</span>.0.0.0/8 <span class="o">[</span>::ffff:127.0.0.0<span class="o">]</span>/104 <span class="o">[</span>::1<span class="o">]</span>/128
<span class="nv">mailbox_size_limit</span> <span class="o">=</span> <span class="m">0</span>
<span class="nv">recipient_delimiter</span> <span class="o">=</span> +
<span class="nv">inet_interfaces</span> <span class="o">=</span> all
<span class="nv">inet_protocols</span> <span class="o">=</span> all

<span class="nv">home_mailbox</span> <span class="o">=</span> Maildir/
<span class="nv">mailbox_command</span> <span class="o">=</span>

<span class="c1"># SASL parameters</span>

<span class="nv">smtpd_sasl_type</span> <span class="o">=</span> dovecot
<span class="nv">smtpd_sasl_path</span> <span class="o">=</span> private/auth
<span class="nv">smtpd_sasl_auth_enable</span> <span class="o">=</span> yes
<span class="nv">smtpd_sasl_tls_security_options</span> <span class="o">=</span> <span class="nv">$smtpd_sasl_security_options</span>
<span class="nv">smtpd_sasl_security_options</span> <span class="o">=</span> noanonymous
<span class="nv">smtpd_recipient_restrictions</span> <span class="o">=</span>
        permit_mynetworks
        permit_sasl_authenticated
        reject_unauth_destination
</code></pre></div>

<h4 id="mastercf">Master.cf</h4>
<div class="codehilite"><pre><span></span><code>master.cf

submission inet n       -       y       -       -       smtpd
  -o <span class="nv">smtpd_tls_security_level</span><span class="o">=</span>encrypt
  -o <span class="nv">smtpd_sasl_auth_enable</span><span class="o">=</span>yes
  -o <span class="nv">smtpd_sasl_type</span><span class="o">=</span>dovecot
  -o <span class="nv">smtpd_sasl_path</span><span class="o">=</span>private/auth
  -o <span class="nv">smtpd_sasl_security_options</span><span class="o">=</span>noanonymous
  -o <span class="nv">smtpd_sasl_local_domain</span><span class="o">=</span>mymail.com
<span class="c1">#  -o smtpd_client_restrictions=permit_sasl_authenticated,reject</span>
<span class="c1">#  -o smtpd_sender_login_maps=hash:/etc/postfix/virtual</span>
<span class="c1">#  -o smtpd_sender_restrictions=reject_sender_login_mismatch</span>
<span class="c1">#  -o smtpd_recipient_restrictions=reject_non_fqdn_recipient,reject_unknown_recipient_domain,permit_sasl_authenticated,reject</span>

smtps     inet  n       -       y       -       -       smtpd
  -o <span class="nv">syslog_name</span><span class="o">=</span>postfix/smtps
  -o <span class="nv">smtpd_tls_wrappermode</span><span class="o">=</span>yes
  -o <span class="nv">smtpd_sasl_auth_enable</span><span class="o">=</span>yes
</code></pre></div>

<h3 id="conf-dovecot">Conf dovecot</h3>
<p>Sección modificada de archivos de configuración dovecot.</p>
<h4 id="dovecotconf">dovecot.conf</h4>
<div class="codehilite"><pre><span></span><code>...
<span class="c1"># A comma separated list of IPs or hosts where to listen in for connections. </span>
<span class="c1"># &quot;*&quot; listens in all IPv4 interfaces, &quot;::&quot; listens in all IPv6 interfaces.</span>
<span class="c1"># If you want to specify non-default ports or anything more complex,</span>
<span class="c1"># edit conf.d/master.conf.</span>
<span class="nv">listen</span> <span class="o">=</span> *, ::

<span class="c1"># extender logs para depurar errores ( opcional )</span>
<span class="nv">auth_verbose</span> <span class="o">=</span> yes
<span class="nv">mail_debug</span> <span class="o">=</span> yes
...
</code></pre></div>

<h4 id="10-authconf">10-auth.conf</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># desabilitar autentificación en texto plano</span>
<span class="nv">disable_plaintext_auth</span> <span class="o">=</span> yes

<span class="c1"># %n eliminar dominio en la autenticación, %Lu minimizar las mayusculas</span>
<span class="nv">auth_username_format</span> <span class="o">=</span> %Lu %n

<span class="c1"># Space separated list of wanted authentication mechanisms:</span>
<span class="c1">#   plain login digest-md5 cram-md5 ntlm rpa apop anonymous gssapi otp skey</span>
<span class="c1">#   gss-spnego</span>
<span class="c1"># NOTE: See also disable_plaintext_auth setting.</span>
<span class="nv">auth_mechanisms</span> <span class="o">=</span> plain login
</code></pre></div>

<h4 id="10-mailconf">10-mail.conf</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># utilizar Maildir como buzon</span>
<span class="nv">mail_location</span> <span class="o">=</span> maildir:~/Maildir
<span class="c1">#mail_location = mbox:~/mail:INBOX=/var/mail/%u</span>


<span class="nv">mail_privileged_group</span> <span class="o">=</span> mail
</code></pre></div>

<h4 id="10-masterconf">10-master.conf</h4>
<div class="codehilite"><pre><span></span><code>...
service imap-login <span class="o">{</span>
  inet_listener imap <span class="o">{</span>
    <span class="nv">port</span> <span class="o">=</span> <span class="m">143</span>
  <span class="o">}</span>
   ...
 <span class="o">}</span>
 ...
 service pop3-login <span class="o">{</span>
  inet_listener pop3 <span class="o">{</span>
    <span class="nv">port</span> <span class="o">=</span> <span class="m">110</span>
  <span class="o">}</span>
  ...
<span class="o">}</span>
...
  <span class="c1"># Postfix smtp-auth</span>
  unix_listener /var/spool/postfix/private/auth <span class="o">{</span>
    <span class="nv">mode</span> <span class="o">=</span> <span class="m">0660</span>
    <span class="nv">user</span> <span class="o">=</span> postfix
    <span class="nv">group</span> <span class="o">=</span> postfix
  <span class="o">}</span>
...
</code></pre></div>

<h4 id="10-sslconf">10-ssl.conf</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># SSL/TLS support: yes, no, required. &lt;doc/wiki/SSL.txt&gt;</span>
<span class="nv">ssl</span> <span class="o">=</span> yes

<span class="c1"># PEM encoded X.509 SSL/TLS certificate and private key. They&#39;re opened before</span>
<span class="c1"># dropping root privileges, so keep the key file unreadable by anyone but</span>
<span class="c1"># root. Included doc/mkcert.sh can be used to easily generate self-signed</span>
<span class="c1"># certificate, just make sure to update the domains in dovecot-openssl.cnf</span>
<span class="nv">ssl_cert</span> <span class="o">=</span> &lt;/etc/ssl/certs/mymail.crt
<span class="nv">ssl_key</span> <span class="o">=</span> &lt;/etc/ssl/private/mymail.key
</code></pre></div>

<h4 id="20-pop3conf">20-pop3.conf</h4>
<p>Esta opcion solo en caso de querer utilizar pop3</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Note that Outlook 2003 seems to have problems with %v.%u format which was</span>
<span class="c1"># Dovecot&#39;s default, so if you&#39;re building a new server it would be a good</span>
<span class="c1"># idea to change this. %08Xu%08Xv should be pretty fail-safe.</span>
<span class="nv">pop3_uidl_format</span> <span class="o">=</span> %08Xu%08Xv
</code></pre></div>

<h3 id="opcional-seguridad">Opcional seguridad</h3>
<p>Requerir un comando HELO o EHLO válido con un nombre de dominio completamente calificado puede hacer precisamente eso</p>
<div class="codehilite"><pre><span></span><code>sudo postconf -e <span class="s1">&#39;smtpd_helo_required = yes&#39;</span>
sudo postconf -e <span class="s1">&#39;smtpd_helo_restrictions = reject_non_fqdn_helo_hostname,reject_invalid_helo_hostname,reject_unknown_helo_hostname&#39;</span>


<span class="c1"># desabiliar veryfy para evitar exponer conf de usuario sensible</span>
sudo postconf -e <span class="s1">&#39;disable_vrfy_command = yes&#39;</span>
</code></pre></div>

<p>También es posible que desee retrasar el mensaje de rechazo para permitir que  Postfix registre la información de la dirección del destinatario cuando  el cliente conectado infringe alguna de las reglas de rechazo. Esto le  permite averiguar más tarde a quién intentaban apuntar los spammers.</p>
<div class="codehilite"><pre><span></span><code>sudo postconf -e <span class="s1">&#39;smtpd_delay_reject = yes&#39;</span>
</code></pre></div>

<p>Las restricciones de destinatario de Postfix que se establecieron en la  parte de configuración de SASL son importantes para proteger el servidor al tiempo que permiten a los usuarios conectarse con clientes de correo electrónico como Thunderbird o Outlook. Mantener estos parámetros en el orden correcto conservará esta capacidad, pero puede incluir  restricciones adicionales que los mensajes entrantes deberán cumplir.</p>
<div class="codehilite"><pre><span></span><code>sudo postconf -e <span class="s1">&#39;smtpd_recipient_restrictions = permit_sasl_authenticated,permit_mynetworks,reject_unauth_destination,reject_invalid_hostname,reject_non_fqdn_hostname,reject_non_fqdn_sender,reject_non_fqdn_recipient,reject_unknown_sender_domain,reject_rbl_client sbl.spamhaus.org,reject_rbl_client cbl.abuseat.org&#39;</span>
</code></pre></div>

<p>Los parámetros anteriores se explican por sí mismos, aunque un poco  difíciles de leer en un formato de terminal fácil de copiar y pegar. La  idea general es rechazar las conexiones de direcciones inventadas que no usan un nombre de dominio completo o simplemente no existen. Aquí  también es posible agregar filtros de spam externos como las listas  negras de Spamhaus o CBL. Si desea obtener más información, Postfix  tiene una documentación muy extensa sobre sus opciones de configuración.</p>
<p>http://www.postfix.org/postconf.5.html#smtpd_recipient_restrictions</p>
<h3 id="comprobar-funcionamiento_1">Comprobar funcionamiento</h3>
<div class="codehilite"><pre><span></span><code>root@debmail:~# openssl s_client -connect correo.mymail.com:993
CONNECTED<span class="o">(</span><span class="m">00000003</span><span class="o">)</span>
....

Por aqui en medio sale string sobre el certificado

....
* OK <span class="o">[</span>CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE LITERAL+ <span class="nv">AUTH</span><span class="o">=</span>PLAIN <span class="nv">AUTH</span><span class="o">=</span>LOGIN<span class="o">]</span> Dovecot <span class="o">(</span>Debian<span class="o">)</span> ready.
. login ventas@mymail.com ventas
. OK <span class="o">[</span>CAPABILITY IMAP4rev1 SASL-IR LOGIN-REFERRALS ID ENABLE IDLE SORT <span class="nv">SORT</span><span class="o">=</span>DISPLAY <span class="nv">THREAD</span><span class="o">=</span>REFERENCES <span class="nv">THREAD</span><span class="o">=</span>REFS <span class="nv">THREAD</span><span class="o">=</span>ORDEREDSUBJECT MULTIAPPEND URL-PARTIAL CATENATE UNSELECT CHILDREN NAMESPACE UIDPLUS LIST-EXTENDED <span class="nv">I18NLEVEL</span><span class="o">=</span><span class="m">1</span> CONDSTORE QRESYNC ESEARCH ESORT SEARCHRES WITHIN <span class="nv">CONTEXT</span><span class="o">=</span>SEARCH LIST-STATUS BINARY MOVE <span class="nv">SNIPPET</span><span class="o">=</span>FUZZY LITERAL+ NOTIFY SPECIAL-USE<span class="o">]</span> Logged in
. <span class="k">select</span> INBOX
* FLAGS <span class="o">(</span><span class="se">\A</span>nswered <span class="se">\F</span>lagged <span class="se">\D</span>eleted <span class="se">\S</span>een <span class="se">\D</span>raft<span class="o">)</span>
* OK <span class="o">[</span>PERMANENTFLAGS <span class="o">(</span><span class="se">\A</span>nswered <span class="se">\F</span>lagged <span class="se">\D</span>eleted <span class="se">\S</span>een <span class="se">\D</span>raft <span class="se">\*</span><span class="o">)]</span> Flags permitted.
* <span class="m">1</span> EXISTS
* <span class="m">0</span> RECENT
* OK <span class="o">[</span>UIDVALIDITY <span class="m">1609316456</span><span class="o">]</span> UIDs valid
* OK <span class="o">[</span>UIDNEXT <span class="m">5</span><span class="o">]</span> Predicted next UID
. OK <span class="o">[</span>READ-WRITE<span class="o">]</span> Select completed <span class="o">(</span><span class="m">0</span>.033 + <span class="m">0</span>.000 + <span class="m">0</span>.037 secs<span class="o">)</span>.
. <span class="nb">logout</span>
* BYE Logging out
. OK Logout completed <span class="o">(</span><span class="m">0</span>.005 + <span class="m">0</span>.000 + <span class="m">0</span>.005 secs<span class="o">)</span>.
closed
</code></pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../samba/" title="Samba" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Samba
              </span>
            </div>
          </a>
        
        
          <a href="../server-mensajeria/" title="Server mensajeria instantanea" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Server mensajeria instantanea
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
    
  </body>
</html>