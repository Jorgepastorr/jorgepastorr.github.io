



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="http://kubernetes.jorgepastorr.tk:50022/Namespaces/">
      
      
        <meta name="author" content="Jorge Pastor">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../images/kubernetes.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Namespaces - Proyecto Kubernetes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="500" height="500" viewBox="0 0 500 500" id="__gitlab"><path fill="currentColor" d="M93.667 473.347l90.684-279.097H2.983l90.684 279.097z" transform="translate(156.198 1.16)"/><path fill="currentColor" d="M221.333 473.345L130.649 194.25H3.557l217.776 279.095z" transform="translate(28.531 1.16)" opacity=".7"/><path fill="currentColor" d="M32 195.155L4.441 279.97a18.773 18.773 0 0 0 6.821 20.99l238.514 173.29L32 195.155z" transform="translate(.089 .256)" opacity=".5"/><path fill="currentColor" d="M2.667-84.844h127.092L75.14-252.942c-2.811-8.649-15.047-8.649-17.856 0L2.667-84.844z" transform="translate(29.422 280.256)"/><path fill="currentColor" d="M2.667 473.345L93.351 194.25h127.092L2.667 473.345z" transform="translate(247.198 1.16)" opacity=".7"/><path fill="currentColor" d="M221.334 195.155l27.559 84.815a18.772 18.772 0 0 1-6.821 20.99L3.557 474.25l217.777-279.095z" transform="translate(246.307 .256)" opacity=".5"/><path fill="currentColor" d="M130.667-84.844H3.575l54.618-168.098c2.811-8.649 15.047-8.649 17.856 0l54.618 168.098z" transform="translate(336.974 280.256)"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#namespaces" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://kubernetes.jorgepastorr.tk:50022" title="Proyecto Kubernetes" aria-label="Proyecto Kubernetes" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../images/logokubernetes.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Proyecto Kubernetes
            </span>
            <span class="md-header-nav__topic">
              
                Namespaces
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://gitlab.com/jorgepastorr/kubernetes/" title="Go to repository" class="md-source" data-md-source="gitlab">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    jorgepastorr/kubernetes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://kubernetes.jorgepastorr.tk:50022" title="Proyecto Kubernetes" class="md-nav__button md-logo">
      
        <img alt="logo" src="../images/logokubernetes.png" width="48" height="48">
      
    </a>
    Proyecto Kubernetes
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://gitlab.com/jorgepastorr/kubernetes/" title="Go to repository" class="md-source" data-md-source="gitlab">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__gitlab" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    jorgepastorr/kubernetes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Kubernetes" class="md-nav__link">
      Kubernetes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Instalaci%C3%B3n/" title="Instalación" class="md-nav__link">
      Instalación
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Pod/" title="Pod" class="md-nav__link">
      Pod
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Replicaset/" title="Replicaset" class="md-nav__link">
      Replicaset
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Deployment/" title="Deployment" class="md-nav__link">
      Deployment
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Services_Endpoints/" title="Services & Endpoints" class="md-nav__link">
      Services & Endpoints
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Namespaces
      </label>
    
    <a href="./" title="Namespaces" class="md-nav__link md-nav__link--active">
      Namespaces
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#namespaces" class="md-nav__link">
    Namespaces
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gestion-manual" class="md-nav__link">
    Gestión manual
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-espacios-de-trabajo" class="md-nav__link">
    Ejemplo espacios de trabajo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template" class="md-nav__link">
    Template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-entre-namespaces" class="md-nav__link">
    Dns entre namespaces
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contexto" class="md-nav__link">
    Contexto
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Limits/" title="Limits" class="md-nav__link">
      Limits
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Probes/" title="Probes" class="md-nav__link">
      Probes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ConfigMaps/" title="ConfigMaps & Environtment" class="md-nav__link">
      ConfigMaps & Environtment
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Secrets/" title="Secrets" class="md-nav__link">
      Secrets
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Volumes/" title="Volumes" class="md-nav__link">
      Volumes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../RBAC/" title="RBAC" class="md-nav__link">
      RBAC
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Ingres/" title="Ingres" class="md-nav__link">
      Ingres
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aws-cli/" title="AWS-clie" class="md-nav__link">
      AWS-clie
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aws/awseks/" title="AWS EKS" class="md-nav__link">
      AWS EKS
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      presentacion
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        presentacion
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../presentacion/diapositiva.html" title="diapositiva" class="md-nav__link">
      diapositiva
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presentacion/diapositiva.pdf" title="diapositiva-pdf" class="md-nav__link">
      diapositiva-pdf
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../presentacion/videos/" title="Videos" class="md-nav__link">
      Videos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#namespaces" class="md-nav__link">
    Namespaces
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gestion-manual" class="md-nav__link">
    Gestión manual
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ejemplo-espacios-de-trabajo" class="md-nav__link">
    Ejemplo espacios de trabajo
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#template" class="md-nav__link">
    Template
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-entre-namespaces" class="md-nav__link">
    Dns entre namespaces
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contexto" class="md-nav__link">
    Contexto
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://gitlab.com/jorgepastorr/kubernetes/edit/master/docs/Namespaces.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Namespaces</h1>
                
                <h2 id="namespaces">Namespaces</h2>
<p>Namespaces son espacios de trabajo dentro de un cluster, donde cada namespace es independiente del otro, es decir los services, deployments, replicasets y pods no se ven entre cada espacio de trabajo. esto es especialmente bueno para trabajar con diferentes departamentos de trabajo, como desarrolladores, sysadmin, ... Otra ventaja es que se puede limitar los espacios de trabajo en los recursos que podrán consumir cada uno de ellos y también en acceso.</p>
<p>Por defecto kubernetes tiene los espacios de trabajo que no debemos tocar <code>kube-public, kube-system y kube-node-lease</code> estos espacios de trabajo los utiliza kubernetes y no es buena practica trastear en ellos. El usuario o administrador trabaja  en el namespace default o uno creado para un grupo especifico.</p>
<div class="codehilite"><pre><span></span><code>sudo kubectl get namespaces              
NAME              STATUS   AGE
default           Active   15d
kube-node-lease   Active   15d
kube-public       Active   15d
kube-system       Active   15d
</code></pre></div>

<p>Comandos </p>
<div class="codehilite"><pre><span></span><code>sudo kubectl get namespaces    <span class="c1"># visualizar</span>
sudo kubectl create namespace test-ns <span class="c1"># crear</span>
sudo kubectl delete namespace test-ns <span class="c1"># eliminar</span>
sudo kubectl describe namespaces test-ns <span class="c1"># inspeccionar</span>
<span class="c1"># ver objeto de namespace -n abreviacion</span>
sudo kubectl get pods<span class="p">|</span>replicasets<span class="p">|</span>deployments<span class="p">|</span>services --namespace test-ns
sudo kubectl get pods<span class="p">|</span>replicasets<span class="p">|</span>deployments<span class="p">|</span>services -n test-ns
<span class="c1"># ver de todos los namespaces -A abreviacion de all-namespaces</span>
sudo kubectl get pods<span class="p">|</span>replicasets<span class="p">|</span>deployments<span class="p">|</span>services -A
</code></pre></div>

<h3 id="gestion-manual">Gestión manual</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Crear namespace simple</span>
sudo kubectl create namespace test-ns
namespace/test-ns created

sudo kubectl get namespaces              
NAME              STATUS   AGE
default           Active   15d
kube-node-lease   Active   15d
kube-public       Active   15d
kube-system       Active   15d
test-ns           Active   5s

<span class="c1"># ver contenido namspace</span>
sudo kubectl describe namespaces test-ns
Name:         test-ns
Labels:       &lt;none&gt;
Annotations:  &lt;none&gt;
Status:       Active

No resource quota.
No LimitRange resource.
</code></pre></div>

<p><strong>resource quota</strong>: Es la limitación de cierta cantidad de recursos, que el namespace no va a ser sobrepasar.</p>
<p><strong>limitRange resource</strong>: Es una manera de controlar recursos a nivel de objetos individuales. Es decir, pods, deployments, replicasets, ...</p>
<h4 id="ejemplo-espacios-de-trabajo">Ejemplo espacios de trabajo</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># creo un pod en el namespace test-ns</span>
sudo kubectl run   --generator<span class="o">=</span>run-pod/v1 podtest --image<span class="o">=</span>nginx:alpine --namespace test-ns 
pod/podtest created

<span class="c1"># desde el namespace default no hay nada</span>
sudo kubectl get pods
No resources found in default namespace.

<span class="c1"># pero en el namespace test-ns se a creado</span>
sudo kubectl get pods -n test-ns
NAME      READY   STATUS    RESTARTS   AGE
podtest   <span class="m">1</span>/1     Running   <span class="m">0</span>          26s

sudo kubectl delete pod podtest -n test-ns
pod <span class="s2">&quot;podtest&quot;</span> deleted

sudo kubectl delete namespaces test-ns    
namespace <span class="s2">&quot;test-ns&quot;</span> deleted
</code></pre></div>

<h4 id="template">Template</h4>
<p>En el siguiente templte se crean dos namespaces, con un deployment en cada uno. Para indicar que un deployment pertenece a un namespace, se le añade en el deployment la metadata <code>namespace: nombre-del-namespace</code> .</p>
<div class="codehilite"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Namespace</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Namespace</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">prod</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">prod</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">annotations</span><span class="p">:</span>
    <span class="nt">kubernetes.io/change-cause</span><span class="p">:</span> <span class="s">&quot;version</span><span class="nv"> </span><span class="s">inicial&quot;</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deployment-test</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">dev</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">front-nginx</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">replicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">matchLabels</span><span class="p">:</span>
      <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">front-nginx</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">metadata</span><span class="p">:</span>
      <span class="nt">labels</span><span class="p">:</span>
        <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">front-nginx</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">containers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
        <span class="nt">ports</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">containerPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">annotations</span><span class="p">:</span>
    <span class="nt">kubernetes.io/change-cause</span><span class="p">:</span> <span class="s">&quot;version</span><span class="nv"> </span><span class="s">inicial&quot;</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">deployment-prod</span>
  <span class="nt">namespace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">prod</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">front-nginx</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">replicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">4</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">matchLabels</span><span class="p">:</span>
      <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">front-nginx</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">metadata</span><span class="p">:</span>
      <span class="nt">labels</span><span class="p">:</span>
        <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">front-nginx</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">containers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
        <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
        <span class="nt">ports</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">containerPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>

<p>Se pude ver como se crea en cada namespace su deployment con sus pods independientes del cada espacio de trabajo.</p>
<div class="codehilite"><pre><span></span><code>sudo kubectl apply -f  namespaces/envs-ns.yml
namespace/dev unchanged
namespace/prod unchanged
deployment.apps/deployment-test created
deployment.apps/deployment-prod created

<span class="c1"># en el namespace default no hay nada</span>
sudo kubectl get deploy     
No resources found in default namespace.

<span class="c1"># el namespace dev esta corriendo el deployment con sus pods</span>
sudo kubectl get deploy -n dev
NAME              READY   UP-TO-DATE   AVAILABLE   AGE
deployment-test   <span class="m">2</span>/2     <span class="m">2</span>            <span class="m">2</span>           81s

sudo kubectl get pods -n dev 
NAME                               READY   STATUS    RESTARTS   AGE
deployment-test-694b78cb4c-2lfp9   <span class="m">1</span>/1     Running   <span class="m">0</span>          2m7s
deployment-test-694b78cb4c-ddcv4   <span class="m">1</span>/1     Running   <span class="m">0</span>          2m7s

<span class="c1"># en el namespace prod corre su deploy y sus pods</span>
sudo kubectl get deploy -n prod
NAME              READY   UP-TO-DATE   AVAILABLE   AGE
deployment-prod   <span class="m">4</span>/4     <span class="m">4</span>            <span class="m">4</span>           99s

sudo kubectl get pods -n prod 
NAME                               READY   STATUS    RESTARTS   AGE
deployment-prod-694b78cb4c-c8w4f   <span class="m">1</span>/1     Running   <span class="m">0</span>          2m
deployment-prod-694b78cb4c-f5bx6   <span class="m">1</span>/1     Running   <span class="m">0</span>          2m
deployment-prod-694b78cb4c-w57ch   <span class="m">1</span>/1     Running   <span class="m">0</span>          2m
deployment-prod-694b78cb4c-z66ln   <span class="m">1</span>/1     Running   <span class="m">0</span>          2m

<span class="c1"># la opcion all-namespaces muestra todo</span>
sudo kubectl get deploy -A
NAMESPACE     NAME              READY   UP-TO-DATE   AVAILABLE   AGE
dev           deployment-test   <span class="m">2</span>/2     <span class="m">2</span>            <span class="m">2</span>           6m59s
kube-system   coredns           <span class="m">2</span>/2     <span class="m">2</span>            <span class="m">2</span>           15d
prod          deployment-prod   <span class="m">4</span>/4     <span class="m">4</span>            <span class="m">4</span>           6m59s
</code></pre></div>

<h4 id="dns-entre-namespaces">Dns entre namespaces</h4>
<p>El dns en un namespace se crea automáticamente y los pods de un mismo espacio de trabajo se ven entre ellos, pero entre espacios de trabajo solo se podran ver a nivel de servicios y especificando el FQDN de la siguiente manera.</p>
<p><code>service-name + namespace-name + svc.cluster.local</code></p>
<p>Ejemplo de dns entre  namespaces.</p>
<div class="codehilite"><pre><span></span><code>sudo kubectl get services -n dev
NAME         TYPE        CLUSTER-IP    EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>    AGE
my-service   ClusterIP   <span class="m">10</span>.98.97.69   &lt;none&gt;        <span class="m">8080</span>/TCP   15m

sudo kubectl run -ti --generator<span class="o">=</span>run-pod/v1 podtest --image<span class="o">=</span>nginx:alpine --namespace default -- sh 
<span class="c1"># no esta en el mismo namespace y no lo ve</span>
/ <span class="c1"># curl my-service:8080</span>
curl: <span class="o">(</span><span class="m">6</span><span class="o">)</span> Could not resolve host: my-service

<span class="c1"># pero con el FQDN llegan a verse.</span>
/ <span class="c1"># curl my-service.dev.svc.cluster.local:8080</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
</code></pre></div>

<h3 id="contexto">Contexto</h3>
<p>El contexto en kubernetes es el espacio de trabajo en el que trabaja un usuario. </p>
<p>Un usuario por defecto trabaja en el namespace default y si es un desarrollador y tiene su namespace desarrollo, tiene que estar indicando siempre <code>-n desarrollo</code>  o  <code>--namespace desarrollo</code> y esto es engorroso.</p>
<p>Para esto mismo existen los contextos, para asignarte un namespace por defecto en un usuario.</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># contexto actual</span>
sudo kubectl config current-context
minikube

<span class="c1"># añadier nuevo contexto context-dev con namespace por defecto dev</span>
sudo kubectl config set-context context-dev --namespace<span class="o">=</span>dev <span class="se">\</span>
  --cluster<span class="o">=</span>minikube <span class="se">\</span>
  --user<span class="o">=</span>minikube

<span class="c1"># usar contexto</span>
sudo kubectl config use-context context-dev
Switched to context <span class="s2">&quot;context-dev&quot;</span>.

<span class="c1"># verificar</span>
sudo kubectl config current-context        
context-dev

<span class="c1"># ahora por defecto muestra los objetos del namespace dev</span>
sudo kubectl get svc 
NAME         TYPE        CLUSTER-IP    EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>    AGE
my-service   ClusterIP   <span class="m">10</span>.98.97.69   &lt;none&gt;        <span class="m">8080</span>/TCP   35m
</code></pre></div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Services_Endpoints/" title="Services & Endpoints" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Services & Endpoints
              </span>
            </div>
          </a>
        
        
          <a href="../Limits/" title="Limits" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Limits
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:".."}})</script>
      
    
  </body>
</html>